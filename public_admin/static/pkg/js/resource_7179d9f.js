;/*!/resource/module/citycode/citycode.jsx*/
define("resource/module/citycode/citycode",function(c,i,e){"use strict";e.exports={tianjin:{code:"022",city:"天津"},shanghai:{code:"021",city:"上海"},beijing:{code:"010",city:"北京"},qingdao:{code:"0532",city:"青岛"}}});
;/*!/resource/module/ship_com/ship_com.jsx*/
define("resource/module/ship_com/ship_com",function(e,t,a){"use strict";var n=e("common/module/util/util"),i=antd.Modal,l=antd.message,s={name_zh:"",name_en:"",contact_name:"",mobile:"",address:""},c=React.createClass({displayName:"Formcom",getInitialState:function(){return{data:s}},handleChange:function(e){this.props.data[e]=event.target.value,this.setState({data:this.props.data})},render:function(){return React.createElement("dl",{className:"x-form"},React.createElement("dd",null,React.createElement("span",{className:"title"},React.createElement("i",null,"*"),"船中文名"),React.createElement("div",{className:"content"},React.createElement("input",{type:"text",value:this.props.data.name_zh,onChange:this.handleChange.bind(this,"name_zh")}))),React.createElement("dd",null,React.createElement("span",{className:"title"},React.createElement("i",null,"*"),"船英文名"),React.createElement("div",{className:"content"},React.createElement("input",{type:"text",value:this.props.data.name_en,onChange:this.handleChange.bind(this,"name_en")}))),React.createElement("dd",null,React.createElement("span",{className:"title"},"联系人"),React.createElement("div",{className:"content"},React.createElement("input",{type:"text",value:this.props.data.contact_name,onChange:this.handleChange.bind(this,"contact_name")}))),React.createElement("dd",null,React.createElement("span",{className:"title"},"联系人电话"),React.createElement("div",{className:"content"},React.createElement("input",{type:"text",value:this.props.data.mobile,onChange:this.handleChange.bind(this,"mobile")}))),React.createElement("dd",null,React.createElement("span",{className:"title"},"联系地址"),React.createElement("div",{className:"content"},React.createElement("input",{type:"text",value:this.props.data.address,onChange:this.handleChange.bind(this,"address")}))))}}),d=React.createClass({displayName:"shipCom",getInitialState:function(){return{visible:!1,loading:!1,data:s,type:"edit"}},show:function(e,t){this.setState({visible:!0,loading:!1,data:e,type:t})},handleOk:function(){var e=this;if(!this.state.data.name_zh||!this.state.data.name_en)return void l.error("必填项未填");var t="/api/ship/addCompany";"edit"==this.state.type&&(t="/api/ship/alterCompany"),this.setState({loading:!0,visible:!0}),n.post(t,this.state.data).then(function(){e.setState({loading:!1,visible:!1}),location.reload()},function(t){e.setState({loading:!1}),l.error(t)})},handleCancel:function(){this.setState({visible:!1,loading:!1})},render:function(){return React.createElement("div",null,React.createElement(i,{title:"edit"==this.state.type?"编辑船公司信息":"添加船公司",visible:this.state.visible,onOk:this.handleOk,footer:[React.createElement("button",{key:"back",className:"ant-btn ant-btn-lg",onClick:this.handleCancel},"返 回"),React.createElement("button",{key:"submit",className:"ant-btn ant-btn-primary ant-btn-lg "+(this.state.loading?"ant-btn-loading":""),onClick:this.handleOk},"提 交")]},React.createElement(c,{data:this.state.data})))}});a.exports=d});
;/*!/resource/module/ship_edit/ship_edit.jsx*/
define("resource/module/ship_edit/ship_edit",function(e,t,a){"use strict";var n=e("common/module/util/util"),i=antd.Modal,l=antd.message,s={name_zh:"",name_en:"",contact_name:"",mobile:"",address:""},c=React.createClass({displayName:"Formcom",getInitialState:function(){return{data:s}},handleChange:function(e){this.props.data[e]=event.target.value,this.setState({data:this.props.data})},render:function(){return React.createElement("dl",{className:"x-form"},React.createElement("dd",null,React.createElement("span",{className:"title"},React.createElement("i",null,"*"),"船中文名"),React.createElement("div",{className:"content"},React.createElement("input",{type:"text",value:this.props.data.name_zh,onChange:this.handleChange.bind(this,"name_zh")}))),React.createElement("dd",null,React.createElement("span",{className:"title"},React.createElement("i",null,"*"),"船英文名"),React.createElement("div",{className:"content"},React.createElement("input",{type:"text",value:this.props.data.name_en,onChange:this.handleChange.bind(this,"name_en")}))),React.createElement("dd",null,React.createElement("span",{className:"title"},"联系人"),React.createElement("div",{className:"content"},React.createElement("input",{type:"text",value:this.props.data.contact_name,onChange:this.handleChange.bind(this,"contact_name")}))),React.createElement("dd",null,React.createElement("span",{className:"title"},"联系人电话"),React.createElement("div",{className:"content"},React.createElement("input",{type:"text",value:this.props.data.mobile,onChange:this.handleChange.bind(this,"mobile")}))),React.createElement("dd",null,React.createElement("span",{className:"title"},"联系地址"),React.createElement("div",{className:"content"},React.createElement("input",{type:"text",value:this.props.data.address,onChange:this.handleChange.bind(this,"address")}))))}}),d=React.createClass({displayName:"shipEdit",getInitialState:function(){return{visible:!1,loading:!1,data:s,type:"edit"}},show:function(e,t){this.setState({visible:!0,loading:!1,data:e,type:t})},handleOk:function(){var e=this;if(!this.state.data.name_zh||!this.state.data.name_en)return l.error("必填项未填"),void this.setState({loading:!1});var t="/api/ship/addShip";"edit"==this.state.type&&(t="/api/ship/alterShip"),this.setState({loading:!0,visible:!0}),n.post(t,this.state.data).then(function(){e.setState({visible:!1,loading:!1}),location.reload()},function(t){e.setState({loading:!1}),l.error(t)})},handleCancel:function(){this.setState({visible:!1,loading:!1})},render:function(){return React.createElement("div",null,React.createElement(i,{title:"edit"==this.state.type?"编辑船信息":"添加船信息",visible:this.state.visible,onOk:this.handleOk,footer:[React.createElement("button",{key:"back",className:"ant-btn ant-btn-lg",onClick:this.handleCancel},"返 回"),React.createElement("button",{key:"submit",className:"ant-btn ant-btn-primary ant-btn-lg "+(this.state.loading?"ant-btn-loading":""),onClick:this.handleOk},"提 交")]},React.createElement(c,{data:this.state.data})))}});a.exports=d});
;/*!/resource/partial/ship/ship.jsx*/
define("resource/partial/ship/ship",function(e,n,i){"use strict";var t=e("common/module/util/util"),d=e("resource/module/ship_edit/ship_edit"),s=(antd.message,antd.Select),a=(s.Option,document.createElement("div"));a.id="pop_shipedit",document.getElementById("popups").appendChild(a),i.exports={init:function(){var e=React.render(React.createElement(d,null),a);t.bind(document.querySelectorAll(".ship_edit"),"click",function(){var n=this.parentNode,i={id:this.getAttribute("data-id"),name_zh:t.siblings(n,"name_zh")[0].innerHTML,name_en:t.siblings(n,"name_en")[0].innerHTML,contact_name:t.siblings(n,"contact_name")[0].innerHTML,mobile:t.siblings(n,"mobile")[0].innerHTML,address:t.siblings(n,"address")[0].innerHTML};e.show(i,"edit")}),t.bind(document.getElementById("add_com"),"click",function(){e.show({name_zh:"",name_en:"",contact_name:"",mobile:"",address:""},"add")})}}});
;/*!/resource/partial/ship_company/ship_company.jsx*/
define("resource/partial/ship_company/ship_company",function(e,n,i){"use strict";var t=e("common/module/util/util"),a=e("resource/module/ship_com/ship_com"),c=(antd.message,antd.Select),d=(c.Option,document.createElement("div"));d.id="pop_shipcom",document.getElementById("popups").appendChild(d),i.exports={init:function(){var e=React.render(React.createElement(a,null),d);t.bind(document.querySelectorAll(".ship_edit"),"click",function(){var n=this.parentNode,i={id:this.getAttribute("data-id"),name_zh:t.siblings(n,"name_zh")[0].innerHTML,name_en:t.siblings(n,"name_en")[0].innerHTML,contact_name:t.siblings(n,"contact_name")[0].innerHTML,mobile:t.siblings(n,"mobile")[0].innerHTML,address:t.siblings(n,"address")[0].innerHTML};e.show(i,"edit")}),t.bind(document.getElementById("add_com"),"click",function(){e.show({name_zh:"",name_en:"",contact_name:"",mobile:"",address:""},"add")})}}});
;/*!/resource/partial/yard/yard.jsx*/
define("resource/partial/yard/yard",function(e,t,a){"use strict";var r=e("common/module/util/util"),n=antd.message,c=antd.Select,l=c.Option;a.exports={init:function(e){function t(e){d.create_type=e,r.redirectParam(d)}var a=null,d=e;"create_type"in d&&(a=d.create_type),React.render(React.createElement(c,{defaultValue:a,style:{width:100},onChange:t,placeholder:"数据来源"},React.createElement(l,{value:"1"},"后台添加"),React.createElement(l,{value:"0"},"用户添加")),document.getElementById("filter-from"));var i=document.querySelector(".filter-input");d.yard_name&&(i.value=d.yard_name),document.getElementById("search").addEventListener("click",function(){return i.value?(d.yard_name=i.value,void r.redirectParam(d)):void n.error("请输入搜索内容")})}}});
;/*!/resource/partial/yard_detail/yard_detail.jsx*/
define("resource/partial/yard_detail/yard_detail",function(t,e,a){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(){var t=document.querySelectorAll(".locations .mark");y.bind(t,"click",function(){var t=this.getAttribute("data-lat"),e=this.getAttribute("data-lng"),a=this.getAttribute("type"),n=this.innerHTML;_(t||e?{title:"重新定位",content:"确定将”"+n+"“位置移动到当前地图中心位置？",onOk:function(){r.addMarker(null,a),f.success("已添加新的【"+n+"】位置，请点击【提交】保存您的修改，或者拖拽移动调整坐标位置",5)}}:{title:"添加定位",content:"在当前地图中心位置添加一个“"+n+"”坐标？",onOk:function(){r.addMarker(null,a),f.success("已添加新的【"+n+"】位置，请点击【提交】保存您的修改，或者拖拽移动调整坐标位置",5)}})}),y.bind(t,"mouseover",function(){var t=this.getAttribute("type");A[t]&&A[t].setAnimation("AMAP_ANIMATION_BOUNCE")}),y.bind(t,"mouseleave",function(){var t=this.getAttribute("type");A[t]&&A[t].setAnimation("AMAP_ANIMATION_NONE")}),y.bind(document.querySelector(".cancle"),"click",function(){location.reload()}),y.bind(document.getElementById("search-btn"),"click",function(){r.search(d.state.value)});var e=document.getElementById("yard-submit"),a=document.getElementById("data_name");y.bind(e,"click",function(){var t=a.value,e=k,n=[];if(!t)return void f.error("请输入堆场名");for(var i=1;5>=i;i++)b["location_type_"+i]&&n.push({location_detail_type:i,latitude:b["location_type_"+i][1],longitude:b["location_type_"+i][0]});var o={yard_name:t,cock_city_code:e,locations:n,yard_id:s};s||delete o.yard_id,y.post("/api/yard/save",o,!0).then(function(t){t.data&&t.data.yard_id?location.href="/yard/yarddetail?yard_id="+t.data.yard_id:location.reload()})})}function o(t){var e=!1;r=new R;for(var a in b)a in t&&t[a].longitude&&t[a].latitude&&(e=!0,r.addMarker([t[a].longitude,t[a].latitude],a));e?r.setViewport():r.setCity(h[k].city)}function c(t,e){var a=document.querySelector(".locations .mark[type="+t+"]"),n=y.siblings(a,"txt");b[t]=[e.lng,e.lat],a.setAttribute("data-lng",e.lng),a.setAttribute("data-lat",e.lat),n[0].innerHTML='<span class="changed">[已修改]</span>'+e.lng+","+e.lat}function l(t){k=t.cock_city_code||"tianjin",s=t.id||"",o(t),u=React.render(React.createElement(E,{from:"table",city:k}),document.getElementById("yard-city")),p=React.render(React.createElement(E,{from:"map",city:k}),document.getElementById("yard-city-map")),d=React.render(React.createElement(M,null),document.getElementById("search-input")),i()}var r,s,u,d,p,m=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),y=t("common/module/util/util"),h=t("resource/module/citycode/citycode"),f=antd.message,v=antd.Select,g=v.Option,_=antd.confirm,k="tianjin",A={location_type_1:"",location_type_2:"",location_type_3:"",location_type_4:"",location_type_5:""},b={location_type_1:"",location_type_2:"",location_type_3:"",location_type_4:"",location_type_5:""},C={location_type_1:"重车入口",location_type_2:"重车出口",location_type_3:"轻车入口",location_type_4:"轻车出口",location_type_5:"堆场中心"},E=React.createClass({displayName:"CitySelect",getInitialState:function(){var t=this.props.city;return{value:t}},changeCity:function(t){k=t,u.setVal(t),p.setVal(t),r.setCity(h[k].city)},setVal:function(t){this.setState({value:t})},render:function(){return React.createElement(v,{defaultValue:"tianjin",value:this.state.value,style:{width:100,height:28,border:"none"},onChange:this.changeCity,placeholder:"城市"},React.createElement(g,{value:"tianjin"},"天津"),React.createElement(g,{value:"shanghai"},"上海"),React.createElement(g,{value:"beijing"},"北京"),React.createElement(g,{value:"qingdao"},"青岛"))}}),M=React.createClass({displayName:"Suggestion",getInitialState:function(){return{tips:[],data:"",value:""}},handleChange:function(){var t=this,e=event.target.value;this.setState({value:e}),AMap.service(["AMap.Autocomplete"],function(){var a={city:h[k].code},n=new AMap.Autocomplete(a);e.length>0&&n.search(e,function(e,a){t.autoComplete(a)})})},closeTip:function(){this.setState({tips:[]})},tipClick:function(){var t=event.target,e=t.getAttribute("data-key"),a="",n=null;a=this.state.data[e]&&this.state.data[e].name?this.state.data[e].name:t.getAttribute("data-name"),this.state.data[e]&&this.state.data[e].location&&(n=this.state.data[e].location),this.setState({value:a,tips:[],data:""}),setTimeout(function(){r.panTo(n)},200)},autoComplete:function(t){var e=this,a=[];t&&t.tips&&(a=t.tips.map(function(t,a){return React.createElement("li",{"data-key":a,onClick:e.tipClick,className:"clearfix","data-name":t.name,"data-lat":t.location?t.location.lat:"","data-lng":t.location?t.location.lng:""},t.name," ",React.createElement("span",{className:"grey"},t.district))}),a.push(React.createElement("li",{className:"tips-close",onClick:this.closeTip},React.createElement("i",{className:"iconfont icon-cuowu"})))),this.setState({tips:a,data:t.tips})},render:function(){return React.createElement("div",null,React.createElement("input",{type:"text",placeholder:"搜索堆场位置",onChange:this.handleChange,value:this.state.value}),React.createElement("ul",{className:"search-tips"},this.state.tips))}}),R=function(){function t(){n(this,t),this.map=new AMap.Map("map",{resizeEnable:!0,center:[116.397428,39.90923],zoom:11})}return m(t,[{key:"addMarker",value:function(t,e){A[e]&&(A[e].setMap(null),A[e]=null),t?b[e]=t:c(e,this.map.getCenter());var a=new AMap.Marker({position:t||this.map.getCenter(),draggable:!0,cursor:"move",raiseOnDrag:!0,offset:{x:-15,y:-30},content:'<i class="iconfont icon-mark '+e+' marker"></i>'});a.setTitle(C[e]),A[e]=a,a.setMap(this.map);var n=document.querySelector(".locations .mark[type="+e+"]");a.on("dragend",function(){c(e,this.getPosition())}),a.on("mouseover",function(){y.addClass(n,"active")}),a.on("mouseout",function(){y.removeClass(n,"active")})}},{key:"panTo",value:function(t){this.map.panTo(t),this.map.setZoom(14)}},{key:"setViewport",value:function(){var t=this;setTimeout(function(){t.map.setFitView()},200)}},{key:"setCity",value:function(t){var e=this;this.map.setCity(t),setTimeout(function(){e.map.setZoom(11)},200)}},{key:"search",value:function(t){var e=this;d.closeTip();var a;AMap.service(["AMap.PlaceSearch"],function(){a=new AMap.PlaceSearch({pageSize:1,pageIndex:1,city:h[k].code}),a.search(t,function(t,a){"complete"===t&&"OK"===a.info&&a.poiList&&a.poiList.pois?(f.success("已定位到"+a.poiList.pois[0].name+"，位于"+a.poiList.pois[0].address),e.map.panTo(a.poiList.pois[0].location),e.map.setZoom(14)):f.error("未找到地址")})})}}]),t}();a.exports=l});