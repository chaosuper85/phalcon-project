define("order/widget/view/order_complete/order_complete",function(e,r,a){function t(e,r){var a=o(r),t={save:$(".order-save")};t.save.on("click",function(){var r=a.fcBox.check(),t=a.shipBox.check(),o=a.productBox.check(),p=a.addressBox.check(),c={},_={},n=e,d={},s={},u=[],m=!0;c.id=r.freight_id.val||"",c.name=r.freight_name.val||"",_.id=r.carteam_id.val||"",_.name=r.carteam_name.val||"",d.ship_company_id=$("#ship_company").attr("data-id")||" ",d.ship_company_name=t.company.val||"",d.ship_name_id=$("#ship_name").attr("data-id")||" ",d.ship_name=t.name.val||"",d.ship_ticket=t.num.val||"",d.yard_id=$("#ship_yard").attr("data-id")||" ",d.yard_name=t.yard.val||"",d.tidan_code=t.tidan.val||"",s.product_box_type=o.product_type.val||"",s.box_type_number=[{number:o["20gp"].val||"",type:"20GP"},{number:o["40gp"].val||"",type:"40GP"},{number:o["40hg"].val||"",type:"40HQ"}],s.product_name=o.product_name.val||"",s.product_weight=o.product_weight.val||"",s.product_notice=o.product_remark.val||"";for(var y=p.length;y--;){var l={};l.box_date=p[y].timeList,l.address_provinceId=p[y].package_location.val.province.id||"",l.address_cityId=p[y].package_location.val.city.id||"",l.address_townId=p[y].package_location.val.area.id||"",l.box_address_detail=p[y].package_address.val||"",l.contactName=p[y].linkman.val,l.contactNumber=p[y].contact.val,u.push(l),m=i(p[y])}return i(r)&&i(t)&&i(o)&&m?void XDD.Request({url:"/carteam/order/confirm",data:{orderid:n,ship_info:d,product_info:s,address_info:u},success:function(e){0===e.error_code?(_alert(e.error_msg||"接单成功！"),window.location.href="/order/list"):_alert(e.error_msg||"未知错误！")}},!0):void _alert("您有信息未填写或填写格式不正确！")})}function i(e){var r=!0;for(var a in e)e[a]&&"boolean"==typeof e[a].checkPass&&!e[a].checkPass&&(r=!1);return r}function o(e){var r,a,t,i;return r=new c({scope:$(".carteam_freight"),config_array:[{keyName:"freight_id",selector:"#freight_id",require:n.no_require,type:n.input_type},{keyName:"freight_name",selector:"#freight_name",require:n.no_require,type:n.input_type},{keyName:"carteam_id",selector:"#carteam_id",require:n.no_require,type:n.input_type},{keyName:"carteam_name",selector:"#carteam_name",require:n.no_require,type:n.input_type}]}),a=new c({scope:$(".ship_info"),config_array:[{keyName:"company",selector:"#ship_company",require:n.is_require,type:n.input_type},{keyName:"tidan",selector:"#tidan",require:n.no_require,type:n.input_type},{keyName:"name",selector:"#ship_name",require:n.is_require,type:n.input_type},{keyName:"num",selector:"#ship_num",require:n.is_require,type:n.input_type},{keyName:"yard",selector:"#ship_yard",require:n.is_require,type:n.input_type}]}),t=new c({scope:$(".product_info"),config_array:[{keyName:"product_type",selector:"#product_type",require:n.input_type,type:n.select_type,selectPlaceholder:"请选择货物箱型",selectOptions:e},{keyName:"20gp",selector:"#product_20gp",require:n.is_require,type:n.weight_type},{keyName:"40gp",selector:"#product_40gp",require:n.is_require,type:n.weight_type},{keyName:"40hg",selector:"#product_40hg",require:n.is_require,type:n.weight_type},{keyName:"product_name",selector:"#product_name",require:n.no_require,type:n.input_type},{keyName:"product_weight",selector:"#product_weight",require:n.is_require,type:n.input_type},{keyName:"product_remark",selector:"#product_remark",require:n.no_require,type:n.input_type}]}),i=new _({item:1}),{fcBox:r,shipBox:a,productBox:t,addressBox:i}}var p=e("common/module/util.js"),c=e("order/widget/view/order_complete/commonBox.js"),_=e("order/widget/view/order_complete/addressBox.js");e("common/module/searchBox/searchBox.js");var n={is_require:!0,no_require:!1,input_type:"INPUT",weight_type:"WEIGHT",select_type:"SELECT"};a.exports={init:function(e,r){var a=[];for(var i in r){var o={value:i,text:r[i]};a.push(o)}$("#ship_company").XDDSearchBox({resKeyName:"china_name",appKeyName:"english_name",keyId:"company_id"}),$("#ship_name").XDDSearchBox({url:"/carteam/order/search_ship_name",resKeyName:"china_name",appKeyName:"eng_name",keyId:"ship_name_id"}),$("#ship_yard").XDDSearchBox({url:"/carteam/order/search_yard",resKeyName:"yard_name",keyId:"yard_id"}),$("#product_weight").on("keydown",function(e){var r=e.keyCode;r>47&&58>r||8!==r&&p.preventDefault(e)}),t(e,a)}}});