define("order/widget/view/order_complete/order_complete",function(e,r,t){function a(e,r,t){var a=o(r,t),c={save:$(".order-save")};c.save.on("click",function(){var r=$(this),t=a.fcBox.check(),o=a.shipBox.check(),c=a.productBox.check(),p=a.addressBox.check(),n={},_={},d=e,s={},u={},m=[],y=!0;n.id=t.freight_id.val||"",n.name=t.freight_name.val||"",_.id=t.carteam_id.val||"",_.name=t.carteam_name.val||"",s.ship_company_id=$("#ship_company").attr("data-id")||" ",s.ship_company_name=o.company.val||"",s.ship_name_id=$("#ship_name").attr("data-id")||" ",s.ship_name=o.name.val||"",s.ship_ticket=o.num.val||"",s.yard_id=o.yard.val||"",s.tidan_code=o.tidan.val||"",u.product_box_type=c.product_type.val||"",u.box_type_number=[{number:c["20gp"].val||"",type:"20GP"},{number:c["40gp"].val||"",type:"40GP"},{number:c["40hg"].val||"",type:"40HQ"}],u.product_name=c.product_name.val||"",u.product_weight=c.product_weight.val||"",u.product_notice=c.product_remark.val||"";for(var l=p.length;l--;){var h={};h.box_date=p[l].timeList,h.address_provinceId=p[l].package_location.val.province.id||"",h.address_cityId=p[l].package_location.val.city.id||"",h.address_townId=p[l].package_location.val.area.id||"",h.box_address_detail=p[l].package_address.val||"",h.contactName=p[l].linkman.val,h.contactNumber=p[l].contact.val,m.push(h),y=i(p[l])}if(!(i(t)&&i(o)&&i(c)&&y))return void _alert("您有信息未填写或填写格式不正确！");var v=r.text();r.html("正在接单..."),r.attr("disabled","disabled"),XDD.Request({url:"/carteam/order/confirm",data:{orderid:d,ship_info:s,product_info:u,address_info:m},success:function(e){0===e.error_code?(_alert(e.error_msg||"接单成功！"),window.location.href="/order/list"):_alert(e.error_msg||"未知错误！"),r.html(v),r.removeAttr("disabled")},error:function(){r.html(v),r.removeAttr("disabled")}},!0)})}function i(e){var r=!0;for(var t in e)e[t]&&"boolean"==typeof e[t].checkPass&&!e[t].checkPass&&(r=!1);return r}function o(e,r){var t,a,i,o;return t=new p({scope:$(".carteam_freight"),config_array:[{keyName:"freight_id",selector:"#freight_id",require:_.no_require,type:_.input_type},{keyName:"freight_name",selector:"#freight_name",require:_.no_require,type:_.input_type},{keyName:"carteam_id",selector:"#carteam_id",require:_.no_require,type:_.input_type},{keyName:"carteam_name",selector:"#carteam_name",require:_.no_require,type:_.input_type}]}),a=new p({scope:$(".ship_info"),config_array:[{keyName:"company",selector:"#ship_company",require:_.is_require,type:_.input_type},{keyName:"tidan",selector:"#tidan",require:_.no_require,type:_.input_type},{keyName:"name",selector:"#ship_name",require:_.is_require,type:_.input_type},{keyName:"num",selector:"#ship_num",require:_.is_require,type:_.input_type},{keyName:"yard",selector:"#ship_yard",require:_.is_require,type:_.select_type,selectPlaceholder:"请选择运抵堆场",selectOptions:r}]}),i=new p({scope:$(".product_info"),config_array:[{keyName:"product_type",selector:"#product_type",require:_.input_type,type:_.select_type,selectPlaceholder:"请选择货物箱型",selectOptions:e},{keyName:"20gp",selector:"#product_20gp",require:_.is_require,type:_.weight_type},{keyName:"40gp",selector:"#product_40gp",require:_.is_require,type:_.weight_type},{keyName:"40hg",selector:"#product_40hg",require:_.is_require,type:_.weight_type},{keyName:"product_name",selector:"#product_name",require:_.no_require,type:_.input_type},{keyName:"product_weight",selector:"#product_weight",require:_.is_require,type:_.input_type},{keyName:"product_remark",selector:"#product_remark",require:_.no_require,type:_.input_type}]}),o=new n({item:1}),{fcBox:t,shipBox:a,productBox:i,addressBox:o}}{var c=e("common/module/util.js"),p=e("order/widget/view/order_complete/commonBox.js"),n=e("order/widget/view/order_complete/addressBox.js");e("common/module/select/select.js")}e("common/module/searchBox/searchBox.js");var _={is_require:!0,no_require:!1,input_type:"INPUT",weight_type:"WEIGHT",select_type:"SELECT"};t.exports={init:function(e,r,t){var i=[];for(var o in r){var p={value:o,text:r[o]};i.push(p)}var n=[];for(var _ in t)n.push({value:t[_].yard_id,text:t[_].yard_name});$("#ship_company").XDDSearchBox({resKeyName:"china_name",appKeyName:"english_name",keyId:"company_id"}),$("#ship_name").XDDSearchBox({url:"/carteam/order/search_ship_name",resKeyName:"china_name",appKeyName:"eng_name",keyId:"ship_name_id"}),$("#product_weight").on("keydown",function(e){var r=e.keyCode;r>47&&58>r||8!==r&&c.preventDefault(e)}),a(e,i,n)}}});