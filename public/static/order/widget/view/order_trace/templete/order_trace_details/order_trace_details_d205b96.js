define("order/widget/view/order_trace/templete/order_trace_details/order_trace_details",function(require,exports,module){function windowOnLoad(){window.onload=function(){setLineHeight()}}function setLineHeight(){DOM.item_line=DOM.item.find(".line"),DOM.item_line.each(function(){var t=$(this),n=t.parent(".traceline").parent("li"),e=n.outerHeight();t.height(e)})}function showBoxDetail(t,n){var e=window.location.href,i=e.indexOf("#/"),o=e.substring(i+2,e.length);DOM.box_details.hide(),o&&!isNaN(o)&&1!=o&&DOM.box_details[o-1]?($(DOM.box_details[o-1]).show(),setLineHeight(),t[o-1]&&t[o-1].location_info?(setMapPoint({packing_point:{lng:t[o-1].location_info.chanzhuang.longitude||0,lat:t[o-1].location_info.chanzhuang.latitude||0},current_point:{lng:t[o-1].location_info.current.longitude||0,lat:t[o-1].location_info.current.latitude||0},drop_point:{lng:t[o-1].location_info.duichang.longitude||0,lat:t[o-1].location_info.duichang.latitude||0}},n),n.getAddressByPoint({point:{lng:t[o-1].location_info.chanzhuang.longitude,lat:t[o-1].location_info.current.latitude}},function(t,n){DOM.trace_address.html(1==t?n.regeocode.formattedAddress:"未定位到司机当前位置！")}),n.map.setFitView()):(n.clear(),DOM.trace_address.html("未定位到司机当前位置！"))):($(DOM.box_details[0]).show(),setLineHeight(),t[0]&&t[0].location_info?(setMapPoint({packing_point:{lng:t[0].location_info.chanzhuang.longitude||0,lat:t[0].location_info.chanzhuang.latitude||0},current_point:{lng:t[0].location_info.current.longitude||0,lat:t[0].location_info.current.latitude||0},drop_point:{lng:t[0].location_info.duichang.longitude||0,lat:t[0].location_info.duichang.latitude||0}},n),n.getAddressByPoint({point:{lng:t[0].location_info.current.longitude||0,lat:t[0].location_info.current.latitude||0}},function(t,n){DOM.trace_address.html(1==t?n.regeocode.formattedAddress:"未定位到司机当前位置！")}),n.map.setFitView()):(n.clear(),DOM.trace_address.html("未定位到司机当前位置！")))}function watchHashChange(t,n){window.onhashchange=function(){showBoxDetail(t,n)}}function setMapPoint(t,n){n.clear();var e=infoWindowTpl({type:"current",text:"当前位置"}),i=infoWindowTpl({type:"normal",text:"产装地址"}),o=infoWindowTpl({type:"normal",text:"落箱堆场"});if(t.current_point&&0!=t.current_point.lng&&0!=t.current_point.lat){n.createMarker({point:t.current_point})}if(t.packing_point&&0!=t.packing_point.lng&&0!=t.packing_point.lat){n.createBespokeMarker({point:t.packing_point,html:i,offset:{left:-50,top:-12}})}if(t.drop_point&&0!=t.drop_point.lng&&0!=t.drop_point.lat){n.createBespokeMarker({point:t.drop_point,html:o,offset:{left:-50,top:-12}})}if(t.current_point&&0!=t.current_point.lng&&0!=t.current_point.lat){n.createInfoWindow({point:t.current_point,html:e,onOpenning:!0,offset:{left:2,top:3}})}}var infoWindowTpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div id="trace-info" class="info ',"undefined"==typeof type?"":baidu.template._encodeHTML(type),'"><div class="text">',"undefined"==typeof text?"":baidu.template._encodeHTML(text),'</div><div class="square"></div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],Map=require("common/module/map/map.js"),DOM={item:$("#trace_details_content .content li"),box_details:$("#trace_details_content .details .box_detail"),trace_address:$("#trace_details_content .box_address span")};module.exports={init:function(t){var n=new Map("trace_map");windowOnLoad(),showBoxDetail(t,n),watchHashChange(t,n)}}});