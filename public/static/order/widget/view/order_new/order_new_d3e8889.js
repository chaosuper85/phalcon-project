define("order/widget/view/order_new/order_new",function(e,n,a){function t(e,n){function a(e){for(var n=0;p>n;n++){var a=e[n].carteamId,t=e[n].carteamName;w[n]={text:t,value:a}}}function t(e,n){var a=$(e).parent(".btn-wrap"),t=$(a).prev(".upload-show"),i=$(t).find(".filename");$(t).removeClass("hidden"),$(i).html(n)}function o(e){var n=$(e).prev(".show-box"),a=$(n).parent(".upload-show"),t=$(n).children(".filename"),i=$(a).parent(".item-content").next(".item-message"),o=$(i).children(".right-message");$(t).html(""),$(a).addClass("hidden"),$(o).addClass("hidden")}function d(e){var n=$(e),a=n.val();return a?a:!1}function s(e){var n=$(e),a=n.val();return/^(\d|[a-zA-Z])+$/.test(a)?a:!1}function l(){var e=D.val();return e}function c(e){{var n=$(e).parents(".item-content"),a=$(n).next(".item-message"),t=$(a).children(".error-message");$(a).children(".right-message")}$(t).removeClass("hidden")}function h(e){var n=$(e).parents(".item-content"),a=$(n).next(".item-message"),t=$(a).children(".china-notice"),i=$(a).children(".right-message");$(t).removeClass("hidden"),$(i).addClass("hidden")}function u(e){var n=$(e).parents(".item-content"),a=$(n).next(".item-message"),t=$(a).children(".error-message"),i=$(a).children(".china-notice"),o=$(a).children(".right-message");$(e).removeClass("error"),$(t).addClass("hidden"),$(o).removeClass("hidden"),$(i).addClass("hidden")}var m,g,f,_,v,p=e.length,w=[],x=n,C=new Date,b=C.getFullYear(),z=C.getMonth()+1,j=C.getDate();v="日期："+b+"-"+(10>z?"0"+z:z)+"-"+(10>j?"0"+j:j),$(".number-left").html(v),console.log("aaa="+v),a(e);var D=new i({container:"#carteam-selector",width:500,heigth:34,options:w,defaultText:"请选择",defaultValue:"0"});$("#upload-chanzhuang").AjaxFileUpload({action:"/api/freight/order/upload_chanzhuang",onSubmit:function(){r.show({btn:$("#order-new .chanzhuang_btn"),txt:"正在上传...",showLoad:!1})},onComplete:function(e,n){console.log(e,n),r.hide(),n.data.pic_url&&(t("#upload-chanzhuang",e),g=n.data.pic_url)},onError:function(){r.hide()}}),$("#upload-tixiang").AjaxFileUpload({action:"/api/freight/order/upload_tixiang",onSubmit:function(){r.show({btn:$("#order-new .tixiang_btn"),txt:"正在上传...",showLoad:!1})},onComplete:function(e,n){console.log(e,n),r.hide(),n.data.pic_url&&(t("#upload-tixiang",e),_=n.data.pic_url)},onError:function(){r.hide()}}),$("#chanzhuang-delete").on("click",function(){o("#chanzhuang-delete"),g=""}),$("#tixiang-delete").on("click",function(){o("#tixiang-delete"),_=""}),$("#tidan_name").blur(function(){var e=$("#tidan_name").val(),n=d("#tidan_name"),a=s("#tidan_name");if(!n)return c("#tidan_name"),$("#tidan_name").focus(),void $("#tidan_name").addClass("error");if(u("#tidan_name"),""!=e||null!=e){if(!a)return h("#tidan_name"),$("#tidan_name").focus(),void $("#tidan_name").addClass("error");u("#tidan_name")}}),$(".order-creat").on("click",function(){var e=$(this);return m=l(),f=d("#tidan_name"),_tidanString=s("#tidan_name"),"0"==m?(c(".select-box"),$(".select-box").focus(),void $(".select-box").addClass("error")):($(".select-box").removeClass("error"),u(".select-box"),g?(u(".chanzhuang-show"),f?(u("#tidan_name"),_tidanString?(u("#tidan_name"),_?(u(".tixiang-show"),r.show({btn:e,txt:"正在创建订单...",showLoad:!1}),void XDD.Request({url:"/freight/order/new",data:{tidan:f,yundan:x,carteamId:m,tixiang:_,chanzhuang:g},success:function(e){0==e.error_code?(_alert("提交成功，请等待审核"),window.location.href="/order/list"):(_alert(e.error_msg),1002==e.error_code&&setTimeout("window.location.href = '/freight/order/choose'",2e3)),r.hide()}},!0)):void c(".tixiang-show")):(h("#tidan_name"),$("#tidan_name").focus(),void $("#tidan_name").addClass("error"))):(c("#tidan_name"),$("#tidan_name").focus(),void $("#tidan_name").addClass("error"))):void c(".chanzhuang-show"))})}e("common/module/upload/uploader.js");var i=e("common/module/select/select.js"),o=e("common/module/loadingBtn/loadingBtn.js"),r=new o;a.exports={init:function(e,n){t(e,n)}}});