define("order/widget/view/order_new/order_new",function(e,n,a){function i(e,n){function a(e){for(var n=0;p>n;n++){var a=e[n].carteamId,i=e[n].carteamName;x[n]={text:i,value:a}}}function i(e,n){var a=$(e).parent(".btn-wrap"),i=$(a).prev(".upload-show"),t=$(i).find(".filename");$(i).removeClass("hidden"),$(t).html(n)}function r(e){var n=$(e).prev(".show-box"),a=$(n).parent(".upload-show"),i=$(n).children(".filename"),t=$(a).parent(".item-content").next(".item-message"),r=$(t).children(".right-message");$(i).html(""),$(a).addClass("hidden"),$(r).addClass("hidden")}function o(e){var n=$(e),a=n.val();return a?a:!1}function s(e){var n=$(e),a=n.val();return/^(\d|[a-zA-Z])+$/.test(a)?a:!1}function c(){var e=D.val();return e}function l(e){{var n=$(e).parents(".item-content"),a=$(n).next(".item-message"),i=$(a).children(".error-message");$(a).children(".right-message")}$(i).removeClass("hidden")}function h(e){var n=$(e).parents(".item-content"),a=$(n).next(".item-message"),i=$(a).children(".china-notice"),t=$(a).children(".right-message");$(i).removeClass("hidden"),$(t).addClass("hidden")}function u(e){var n=$(e).parents(".item-content"),a=$(n).next(".item-message"),i=$(a).children(".error-message"),t=$(a).children(".china-notice"),r=$(a).children(".right-message"),d=$(a).children(".ajax-notice");$(e).removeClass("error"),$(i).addClass("hidden"),$(r).removeClass("hidden"),$(t).addClass("hidden"),$(d).addClass("hidden")}var m,g,f,_,v,p=e.length,x=[],w=n,C=new Date,b=C.getFullYear(),j=C.getMonth()+1,z=C.getDate();v="日期："+b+"-"+(10>j?"0"+j:j)+"-"+(10>z?"0"+z:z),$(".number-left").html(v),console.log("aaa="+v),a(e);var D=new t({container:"#carteam-selector",width:500,heigth:34,options:x,defaultText:"请选择",defaultValue:"0"});$("#upload-chanzhuang").AjaxFileUpload({action:"/api/freight/order/upload_chanzhuang",onSubmit:function(){d.show({btn:$("#order-new .chanzhuang_btn"),txt:"正在上传...",showLoad:!1})},onComplete:function(e,n){console.log(e,n),d.hide(),n.data.pic_url&&(i("#upload-chanzhuang",e),g=n.data.pic_url)},onError:function(){d.hide()}}),$("#upload-tixiang").AjaxFileUpload({action:"/api/freight/order/upload_tixiang",onSubmit:function(){d.show({btn:$("#order-new .tixiang_btn"),txt:"正在上传...",showLoad:!1})},onComplete:function(e,n){console.log(e,n),d.hide(),n.data.pic_url&&(i("#upload-tixiang",e),_=n.data.pic_url)},onError:function(){d.hide()}}),$("#chanzhuang-delete").on("click",function(){r("#chanzhuang-delete"),g=""}),$("#tixiang-delete").on("click",function(){r("#tixiang-delete"),_=""}),$("#tidan_name").keyup(function(){var e=$(this),n=e.val();n.replace(/\s/g,"")}),$("#tidan_name").blur(function(){var e=$(this),n=e.val().replace(/\s/g,""),a=o("#tidan_name"),i=s("#tidan_name"),t=e.parents(".item-content").next(".item-message");if(!a)return l("#tidan_name"),t.children(".right-message").hide(),t.children(".ajax-notice").hide(),t.children(".china-notice").hide(),$("#tidan_name").focus(),$("#tidan_name").addClass("error"),!1;if(u("#tidan_name"),""!=n||null!=n){if(!i)return t.children(".china-notice").show(),h("#tidan_name"),t.children(".right-message").hide(),t.children(".ajax-notice").hide(),$("#tidan_name").focus(),$("#tidan_name").addClass("error"),!1;u("#tidan_name"),t.children(".china-notice").hide()}else t.children(".china-notice").hide(),t.children(".error-message").show();XDD.Request({url:"/freight/order/ladingCodeExist?tidanCode="+a,success:function(e){return 0!=e.error_code?(t.children(".ajax-notice").show(),t.children(".right-message").hide(),$("#tidan_name").addClass("error"),!1):(t.children(".right-message").show(),void t.children(".ajax-notice").hide())}})}),$(".order-creat").on("click",function(){var e=$(this);return m=c(),f=o("#tidan_name"),_tidanString=s("#tidan_name"),"0"==m?(l(".select-box"),$(".select-box").focus(),void $(".select-box").addClass("error")):($(".select-box").removeClass("error"),u(".select-box"),g?(u(".chanzhuang-show"),f?(u("#tidan_name"),_tidanString?(u("#tidan_name"),_?(u(".tixiang-show"),d.show({btn:e,txt:"正在创建...",showLoad:!1}),e.attr("disabled","disabled"),void XDD.Request({url:"/freight/order/ladingCodeExist?tidanCode="+f,success:function(n){0==n.error_code?XDD.Request({url:"/freight/order/new",data:{tidan:f,yundan:w,carteamId:m,tixiang:_,chanzhuang:g},success:function(n){0==n.error_code?(_alert("提交成功，请等待审核"),window.location.href="/order/list"):(_alert(n.error_msg),1002==n.error_code&&setTimeout("window.location.href = '/freight/order/choose'",2e3)),d.hide(),e.removeAttr("disabled")},error:function(){d.hide(),e.removeAttr("disabled")}},!0):($("#tidan_name").addClass("error"),d.hide(),e.removeAttr("disabled"))},error:function(){d.hide(),e.removeAttr("disabled")}})):void l(".tixiang-show")):(h("#tidan_name"),$("#tidan_name").focus(),void $("#tidan_name").addClass("error"))):(l("#tidan_name"),$("#tidan_name").focus(),void $("#tidan_name").addClass("error"))):void l(".chanzhuang-show"))})}e("common/module/upload/uploader.js");var t=e("common/module/select/select.js"),r=e("common/module/loadingBtn/loadingBtn.js"),d=new r;a.exports={init:function(e,n){i(e,n)}}});