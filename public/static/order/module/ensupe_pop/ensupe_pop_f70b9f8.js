define("order/module/ensupe_pop/ensupe_pop",function(require,exports,module){function EnsupePop(e){function i(e){this.type=e.type,this.DOM={};this.DOM={title:this.pop.find(".editBoxNum-title .title-text"),comfireBtn:this.pop.find(".editBoxNum-title .editBoxNum-comfire .comfireBtn"),cancelBtn:this.pop.find(".editBoxNum-title .editBoxNum-cancel .cancelBtn"),boxId:this.pop.find(".editBoxNum-items #editBoxNum-box-id"),boxNum:this.pop.find(".editBoxNum-items #editBoxNum-box-num"),sealNum:this.pop.find(".editBoxNum-items #editBoxNum-seal-num")},r(this);var i=this;this.DOM.cancelBtn.on("click",function(){i.hide()}),this.DOM.comfireBtn.on("click",function(){o(i,$(this))}),this.DOM.boxNum.on("keyup",function(){var e=$(this),i=s(e),r=t("#editBoxNum-box-num");if(util.isNull(e.val()))i.error.show(),i.right.hide(),i.rule.hide(),e.addClass("error");else if(r)i.rule.hide(),i.error.hide(),i.right.show(),e.removeClass("error"),$(".comfireBtn").attr("disabled",!1);else if(!r)return i.rule.show(),i.error.hide(),i.right.hide(),e.addClass("error"),$(".comfireBtn").attr("disabled",!0),!1}),this.DOM.sealNum.on("keyup",function(){var e=$(this),i=s(e),r=t("#editBoxNum-seal-num");if(util.isNull(e.val()))i.error.show(),i.right.hide(),i.rule.hide(),e.addClass("error");else if(r)i.rule.hide(),i.error.hide(),i.right.show(),e.removeClass("error"),$(".comfireBtn").attr("disabled",!1);else if(!r)return i.rule.show(),i.error.hide(),i.right.hide(),e.addClass("error"),$(".comfireBtn").attr("disabled",!0),!1}),this.DOM.boxNum.blur(function(){var e=$(this),i=e.val(),r=t("#editBoxNum-box-num"),o=s(e);if(util.isNull(i))o.error.show(),o.right.hide(),o.rule.hide(),e.addClass("error");else if(r)o.rule.hide(),o.error.hide(),o.right.show(),e.removeClass("error"),$(".comfireBtn").attr("disabled",!1);else if(!r)return o.rule.show(),o.error.hide(),o.right.hide(),e.addClass("error"),$(".comfireBtn").attr("disabled",!0),!1}),this.DOM.sealNum.blur(function(){var e=$(this),i=e.val(),r=t("#editBoxNum-seal-num"),o=s(e);if(util.isNull(i))o.error.show(),o.right.hide(),o.rule.hide(),e.addClass("error");else if(r)o.rule.hide(),o.error.hide(),o.right.show(),e.removeClass("error"),$(".comfireBtn").attr("disabled",!1);else if(!r)return o.rule.show(),o.error.hide(),o.right.hide(),e.addClass("error"),$(".comfireBtn").attr("disabled",!0),!1})}function r(e){e.DOM.title.text(d),e.DOM.boxId.val(m.data.id),e.DOM.boxNum.val(m.data.boxNum),e.DOM.sealNum.val(m.data.sealNum)}function t(e){var i=$(e),r=i.val();return/^(\d|[a-zA-Z])+$/.test(r)?r:!1}function o(e,i){var r,t;if("add"===e.type){r={box_code:e.DOM.boxNum.val(),box_ensupe:e.DOM.sealNum.val(),order_box_id:e.DOM.boxId.val(),order_freight_id:m.data.orderId},t="上传成功！"}else{r={order_box_id:e.DOM.boxId.val(),box_code:e.DOM.boxNum.val(),box_ensupe:e.DOM.sealNum.val(),order_freight_id:m.data.orderId},t="修改成功！"}var o=s(e.DOM.boxNum),d=s(e.DOM.sealNum);if(util.isNull(e.DOM.boxNum.val()))return a(e.DOM.boxNum),o.error.show(),o.right.hide(),void e.DOM.boxNum.addClass("error");if(o.error.hide(),o.right.show(),e.DOM.boxNum.removeClass("error"),util.isNull(e.DOM.sealNum.val()))return a(e.DOM.sealNum),d.error.show(),d.right.hide(),void e.DOM.sealNum.addClass("error");d.error.hide(),d.right.show(),e.DOM.sealNum.removeClass("error");var l=i.text();i.html("正在提交..."),i.attr("disabled","disabled"),XDD.Request({url:"/carteam/order/check_box_code",data:r,success:function(o){0==o.error_code?XDD.Request({url:"/carteam/order/save_box_ensupe",data:r,success:function(o){0==o.error_code?(e.hide(),_alert(t),window.location.reload(),"function"==typeof e.onComplete&&e.onComplete(r)):_alert(o.error_msg||"未知错误！"),i.html(l),i.removeAttr("disabled")},error:function(){i.html(l),i.removeAttr("disabled")}},!0):(_alert(o.error_msg),i.html(l),i.removeAttr("disabled"))}},!0)}function a(e){e.animate({marginLeft:"-1px"},40).animate({marginLeft:"2px"},40).animate({marginLeft:"-2px"},40).animate({marginLeft:"1px"},40)}function s(e){var i={message:e.parents(".item-content").siblings(".item-message")};return i.error=i.message.find(".error-message"),i.right=i.message.find(".right-message"),i.rule=i.message.find(".error-rule"),i}var d,l={data:{id:"",boxNum:"",sealNum:"",orderId:""},type:"add"},m=$.extend({},l,e);return d="add"===m.type?"上传箱号/铅封号":"修改箱号/铅封号",i.prototype=new popup({height:300,width:700,tpl:tpl}),i.prototype.constructor=i,i.prototype.setAdd=function(e){type=this.type="add",d="上传箱号/铅封号",this.DOM.title.text(d),this.DOM.boxId.val(e.boxId),this.DOM.boxNum.val(""),this.DOM.sealNum.val("");var i=s(this.DOM.boxNum),r=s(this.DOM.sealNum);i.error.hide(),r.error.hide(),i.right.hide(),r.right.hide(),this.DOM.boxNum.removeClass("error"),this.DOM.sealNum.removeClass("error")},i.prototype.setEdit=function(e){if(e.boxId&&e.boxNum&&e.sealNum){type=this.type="edit",d="修改箱号/铅封号",this.DOM.title.text(d),this.DOM.boxId.val(e.boxId),this.DOM.boxNum.val(e.boxNum),this.DOM.sealNum.val(e.sealNum);var i=s(this.DOM.boxNum),r=s(this.DOM.sealNum);i.error.hide(),r.error.hide(),i.right.hide(),r.right.hide(),this.DOM.boxNum.removeClass("error"),this.DOM.sealNum.removeClass("error")}},i.prototype.onComplete=function(){},new i(m)}var popup=require("common/module/popup/popup.js"),util=require("common/module/util.js"),tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div id="editBoxNum"><div class="editBoxNum-title clearfix"><div class="editBoxNum-cancel"><button class="cancelBtn">取消</button></div><div class="title-text">上传箱号/铅封号</div><div class="editBoxNum-comfire"><button class="comfireBtn">确定</button></div></div><dl class="editBoxNum-items clearfix"><dd class="item"><div class="item-name"><label for="editBoxNum-box-num">箱号：</label></div><div class="item-content"><input type="hidden" id="editBoxNum-box-id" name="editBoxNum-box-id" value="" /><input type="text" placeholder="请输入箱号" id="editBoxNum-box-num" name="editBoxNum-box-num" value="" /maxlength="11"></div><div class="item-message clearfix"><div class="error-rule hidden"><i class="icon-warn"></i><span>箱号只能是数字或者英文字母组成</span></div><div class="error-message hidden"><i class="icon-warn"></i><span>您未输入箱号</span></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dd><dd class="item-ensupe"><div class="item-name"><label for="editBoxNum-box-num"></label></div></dd><dd class="item"><div class="item-name"><label for="editBoxNum-seal-num">铅封号：</label></div><div class="item-content"><input type="text" placeholder="请输入铅封号" id="editBoxNum-seal-num" name="editBoxNum-seal-num" value="" maxlength="30"/></div><div class="item-message clearfix"><div class="error-rule hidden"><i class="icon-warn"></i><span>铅封号只能是数字或者英文字母组成</span></div><div class="error-message hidden"><i class="icon-warn"></i><span>您未输入铅封号</span></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dd><dd class="item-ensupe"><div class="item-name"><label for="editBoxNum-box-num"></label></div></dd></dl></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0];module.exports=EnsupePop});