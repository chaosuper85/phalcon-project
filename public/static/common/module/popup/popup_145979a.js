define("common/module/popup/popup",function(t,e,o){function p(t){var e=this.title=t.title||"",o=this.height=t.height||500,p=this.width=t.width||500,n=this.tpl=t.tpl||function(){return""},s=this.data=t.data||{},c=this.pop=$('<div class="popup"></div>'),d='<h2 class="unselectable"><span class="pop-title">'+e+'</span><a class="pop-close" title="关闭"></a></h2>',h='<div class="content"></div>';if($(".popup-bg").length>0)var u=this.bg=$(".popup-bg");else{var u=this.bg=$('<div class="popup-bg"></div>');a.append(u)}c.css("height",o+"px"),c.css("width",p+"px"),a.append(c),c.append(e?d:'<a class="pop-close" title="关闭"></a>'),c.append(h),c.find(".content").append(n(s)),i(this)}function i(t){var e=t,o=e.pop.find(".pop-close");n({obj:e.pop,title:e.pop.find("h2")}),o.bind("click",function(){e.hide()}),e.bg.bind("click",function(){e.hide()})}function n(t){var e=t.obj,o=t.title;if("undefined"!=typeof o[0]){var p,i,n={x:0,y:0},a={x:"",y:""};o.on("mousedown",function(t){return"a"!=t.target.tagName.toLowerCase()?($("body").addClass("unselectable"),o.setCapture&&o.setCapture(),n.x=parseInt(e.css("left")),n.y=parseInt(e.css("top")),a=s(t),p=a.x-n.x,i=a.y-n.y,$(document).bind("mousemove",function(t){mousemove_point=s(t);var o=mousemove_point.x-p,n=mousemove_point.y-i;e.css({top:n,left:o})}).bind("mouseup",function(){$("body").removeClass("unselectable"),o.releaseCapture&&o.releaseCapture(),$(this).unbind("mousemove"),$(document).unbind("mousemove").unbind("mouseup")}),!1):void 0})}}function s(t){return t=t||window.event,t.pageX||t.pageY?{x:t.pageX,y:t.pageY}:{x:t.clientX+document.body.scrollLeft-document.body.clientLeft,y:t.clientY+document.body.scrollTop-document.body.clientTop}}var a=$("body"),c=$(window);p.prototype.show=function(){var t=this.height,e=this.width;this.pop.css("left",c.width()/2-parseInt(e)/2+"px"),this.pop.css("top",c.height()/2.5-parseInt(t)/2+"px"),this.pop.css("opacity",0).show(),this.bg.css("opacity",0).show(),this.bg.animate({opacity:.7},300),this.pop.animate({opacity:1},300)},p.prototype.hide=function(){this.pop.hide(),this.bg.hide()},p.prototype.setTitle=function(t){var e=this.pop.find(".pop-title");e.html(t)},p.prototype.setHeight=function(t){var e=this.pop;e.css("height",t+"px")},p.prototype.setContent=function(t){var e=this.pop.find(".content");e.empty().html(t)},o.exports=p});