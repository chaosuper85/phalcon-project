define("user/widget/view/account_company/company",function(e,n,t){function o(e){function n(e){{var n=e.split(".");n.length-1}}function t(e,n){if(n)var t=b.val(),o=t.city.id;else var o=w.val();return o>0?(g=1,o):(g=0,!1)}function o(e){var n=$(e),t=n.val();return t?(g=1,t):(g=0,!1)}function s(){var e=N.val(),n=new Date(e.replace("-","/").replace("-","/")),t=new Date,o="";o+=t.getFullYear()+"-",o+=t.getMonth()+1+"-",o+=t.getDate()+"-";var c=new Date(o.replace("-","/").replace("-","/"));return n>c?(console.log(e),g=0,!1):(g=1,e)}function u(e){var n=$(e).val();return n&&r.isNumber(n)?(g=1,n):(g=0,!1)}function m(e){console.log("aa",$(e)),$(e).animate({marginLeft:"-1px"},40).animate({marginLeft:"2px"},40).animate({marginLeft:"-2px"},40).animate({marginLeft:"1px"},40).animate({marginLeft:"0px"},40).focus()}function d(e){var n=$(e).closest(".content").siblings(".tip");$(n).removeClass("invisible"),$(n).children("i").removeClass("i-right"),g=0}function f(e){var n=$(e).closest(".content").siblings(".tip"),t=n.children("i");$(n).removeClass("invisible"),$(t).addClass("i-right")}var p,v,g=0,b=new c({wrap:"#address-selector",level:2,width:160,height:40}),h="货代用户",y="车队用户";"2"==e?v=h:"1"==e&&(v=y);var _,M,w=new i({container:"#type-selector",options:[{text:"货代用户",value:"2"},{text:"车队用户",value:"1"}],defaultText:v,defaultValue:e,height:40}),x=new Date,j=+x.getFullYear(),N=new l({wrap:"#company_date_selectBox",ed_year:j,width:70,height:40});$("#upload-license").AjaxFileUpload({onComplete:function(e,t){console.log(e,t);var o=n(e);o&&($("#img-license").attr("src",t.data.pic_url),_=t.data.pic_url,$(".img-license-content").removeClass("hidden"),f(".img-license-content"))}}),$("#img-clean").on("click",function(){$("#img-license").attr("src",""),$(".img-license-content").addClass("hidden"),d(".img-license-content"),_="",g=0}),$(".license").on("click",function(){var e=$(".license").attr("src");window.open(e)}),$("#submitInfo").on("click",function(){function e(){$("#confirmBtn").on("click",function(){n(),p.hide()}),$("#cancelBtn").on("click",function(){console.log("cancle"),p.hide(),$("#confirmBtn").unbind("click")})}function n(){XDD.Request({url:"/account/do_apply",data:{enterpriseName:c,type:i,cityCode:l,builddate:r,contactMobile_city:v,contactMobile_number:b,contactMobile_fenji:h,licenceNumber:y,licencePic:M},success:function(e){0==e.error_code?(_alert("提交成功，请等待审核"),$(".pop-close").on("click",function(){location.href="/account/enterpriseInfo"}),$(".popup-bg").on("click",function(){location.href="/account/enterpriseInfo"})):_alert(e.error_msg)}},!0)}var c=o("#enterpriseName");if(!c)return m("#enterpriseName"),void d("#enterpriseName");f("#enterpriseName");var i=t("#type-selector");if(!i)return m("#type-selector"),void d("#type-selector");console.log("选择了",i),f("#type-selector"),"1"==i?i="carteam":"2"==i&&(i="freight_agent"),console.log("类型 = "+i);var l=t("#address-selector","1");if(!l)return m("#address-selector"),void d("#address-selector");f("#address-selector");var r=s("#company_date_selectBox");if(!r)return m("#company_date_selectBox"),void d("#company_date_selectBox");f("#company_date_selectBox");var v=u("#contactMobile-city");if(!v)return m("#contactMobile-city"),void d("#contactMobile-city");if(3!=v.length&&4!=v.length)return m("#contactMobile-city"),void d("#contactMobile-city");f("#contactMobile-city");var b=u("#contactMobile-number");if(!b)return m("#contactMobile-number"),void d("#contactMobile-number");if(7!=b.length&&8!=b.length)return m("#contactMobile-number"),void d("#contactMobile-number");f("#contactMobile-number");var h=u("#contactMobile-fenji");if(h){if(h.length<3||h.length>5)return alert("000"),m("#contactMobile-fenji"),void d("#contactMobile-fenji");f("#contactMobile-fenji")}else f("#contactMobile-fenji"),console.log("fenji=",h);var y=u("#licenseNumber");return y?(f("#licenseNumber"),M=_?_:$("#img-license").attr("src"),console.log(r+"---------"+M),M?(g=1,f("#img-license"),0==g?!1:void(1==g&&(p?p.show():(p=new a,p.setData("公司信息一经提交，不能修改"),p.show()),e()))):(d("#img-license"),void(g=0))):(m("#licenseNumber"),void d("#licenseNumber"))})}e("common/module/upload/uploader.js");var c=e("common/module/address/address.js"),i=e("common/module/select/select.js"),l=e("common/module/selectTimeBox/selectTimeBox.js"),a=e("common/module/confirm/confirm.js"),r=e("common/module/util.js");t.exports={init:function(e){o(e)}}});