;/*!/user/widget/header/header.js*/
define("user/widget/header/header",function(e,o,n){var c=e("index/module/apps/apps.js"),t=c();n.exports=function(){$("#logout").click(function(){XDD.Request({type:"GET",url:"/index/logout",success:function(e){0==e.error_code?location.href="/":_alert(e.error_msg)}})}),$("#ucenter").click(function(){location.href="/account/personalInfo"}),$("#apps-btn").click(function(){t.show()})}});
;/*!/user/widget/view/account_company/company.js*/
define("user/widget/view/account_company/company",function(e,t,n){function o(e){function t(e){{var t=e.split(".");t.length-1}return!0}function n(e){var t=$("#licenseNumber").val();XDD.Request({url:"/account/licenceCodeExist",data:{licenceCode:t},success:function(t){"function"==typeof e&&e(t)}},!0)}function o(e,t){if(t)var n=h.val(),o=n.city.id;else var o=w.val();return o>0?(g=1,o):(g=0,!1)}function s(e){var t=$(e),n=t.val();return n?(g=1,n):(g=0,!1)}function u(){var e=B.val(),t=new Date(e.replace("-","/").replace("-","/")),n=new Date,o="";o+=n.getFullYear()+"-",o+=n.getMonth()+1+"-",o+=n.getDate()+"-";var c=new Date(o.replace("-","/").replace("-","/"));return t>c?(console.log(e),g=0,!1):(g=1,e)}function m(e){var t=$(e).val();return t&&a.isNumber(t)?(g=1,t):(g=0,!1)}function d(e){$(e).animate({marginLeft:"-1px"},40).animate({marginLeft:"2px"},40).animate({marginLeft:"-2px"},40).animate({marginLeft:"1px"},40).animate({marginLeft:"0px"},40).focus()}function f(e){var t=$(e).closest(".content").siblings(".tip");$(t).removeClass("invisible"),$(t).children("i").removeClass("i-right"),g=0}function v(e){var t=$(e).closest(".content").siblings(".tip"),n=t.children("i");$(t).removeClass("invisible"),$(n).addClass("i-right")}var p,b,g=0,h=new c({wrap:"#address-selector",level:2,width:160,height:40}),_="货代用户",y="车队用户";"2"==e?b=_:"1"==e&&(b=y);var M,x,w=new i({container:"#type-selector",options:[{text:"货代用户",value:"2"},{text:"车队用户",value:"1"}],defaultText:b,defaultValue:e,height:40}),j=new Date,N=+j.getFullYear(),B=new r({wrap:"#company_date_selectBox",ed_year:N,width:70,height:40});$("#upload-license").AjaxFileUpload({onComplete:function(e,n){console.log(e,n);var o=t(e);o&&($("#img-license").attr("src",n.data.pic_url),M=n.data.pic_url,$(".img-license-content").removeClass("hidden"),v(".img-license-content"))}}),$("#img-clean").on("click",function(){$("#img-license").attr("src",""),$(".img-license-content").addClass("hidden"),f(".img-license-content"),M="",g=0}),$(".license").on("click",function(){var e=$(".license").attr("src");window.open(e)}),$("#submitInfo").on("click",function(){var e=s("#enterpriseName");if(!e)return d("#enterpriseName"),void f("#enterpriseName");v("#enterpriseName");var t=o("#type-selector");if(!t)return d("#type-selector"),void f("#type-selector");console.log("选择了",t),v("#type-selector"),"1"==t?t="carteam":"2"==t&&(t="freight_agent"),console.log("类型 = "+t);var c=o("#address-selector","1");if(!c)return d("#address-selector"),void f("#address-selector");v("#address-selector");var i=u("#company_date_selectBox");if(!i)return d("#company_date_selectBox"),void f("#company_date_selectBox");v("#company_date_selectBox");var r=m("#contactMobile-city");if(!r)return d("#contactMobile-city"),void f("#contactMobile-city");if(3!=r.length&&4!=r.length)return d("#contactMobile-city"),void f("#contactMobile-city");v("#contactMobile-city");var a=m("#contactMobile-number");if(!a)return d("#contactMobile-number"),void f("#contactMobile-number");if(7!=a.length&&8!=a.length)return d("#contactMobile-number"),void f("#contactMobile-number");v("#contactMobile-number");var b=m("#contactMobile-fenji");if(b){if(b.length<3||b.length>5)return d("#contactMobile-fenji"),void f("#contactMobile-fenji");v("#contactMobile-fenji")}else v("#contactMobile-fenji"),console.log("fenji=",b);var h=m("#licenseNumber");return h?void n(function(n){function o(){$("#confirmBtn").on("click",function(){s($(this)),p.hide()}),$("#cancelBtn").on("click",function(){console.log("cancle"),p.hide(),$("#confirmBtn").unbind("click")})}function s(n){var o=n.text();n.html("正在提交..."),n.attr("disabled","disabled"),XDD.Request({url:"/account/do_apply",data:{enterpriseName:e,type:t,cityCode:c,builddate:i,contactMobile_city:r,contactMobile_number:a,contactMobile_fenji:b,licenceNumber:h,licencePic:x},success:function(e){0==e.error_code?(_alert("提交成功，请等待审核"),$(".pop-close").on("click",function(){location.href="/account/enterpriseInfo"}),$(".popup-bg").on("click",function(){location.href="/account/enterpriseInfo"})):_alert(e.error_msg),n.html(o),n.removeAttr("disabled")},error:function(){n.html(o),n.removeAttr("disabled")}},!0)}return 0==n.error_code?(g=1,v("#licenseNumber")):(_alert(n.error_msg),g=0,d("#licenseNumber"),f("#licenseNumber")),0!=g?(x=M?M:$("#img-license").attr("src"),console.log(i+"---------"+x),x?(g=1,v("#img-license"),0==g?!1:void(1==g&&(p?p.show():(p=new l,p.setData("公司信息一经提交，不能修改"),p.show()),o()))):(f("#img-license"),void(g=0))):void 0}):(d("#licenseNumber"),void f("#licenseNumber"))})}e("common/module/upload/uploader.js");var c=e("common/module/address/address.js"),i=e("common/module/select/select.js"),r=e("common/module/selectTimeBox/selectTimeBox.js"),l=e("common/module/confirm/confirm.js"),a=e("common/module/util.js");n.exports={init:function(e){o(e)}}});
;/*!/user/widget/view/account_info/account_info.js*/
define("user/widget/view/account_info/account_info",function(e,t,n){function i(){for(var e=0;2>=e;e++){var t=$("#user_info .input"+e),n=t.prev(),i=n.text();t.val(n.hasClass("none")?"":i),t.show()}}function a(){var e=$("#input-name"),t=e.val();return t?(s(e),t):(u(e),!1)}function o(){var e=$("#input-phone"),t=e.val();return t&&c.isMobilePhone(t)?(s(e),t):(u(e),!1)}function r(){var e=$("#input-telephone"),t=e.val();return t&&c.isTelephone(t)?(s(e),t):(u(e),!1)}function s(e){var t=e.siblings(".tip");t.addClass("pass").removeClass("invisible")}function u(e){var t=e.siblings(".tip");t.removeClass("pass").removeClass("invisible"),l(e)}function l(e){e.animate({marginLeft:"-1px"},40).animate({marginLeft:"2px"},40).animate({marginLeft:"-2px"},40).animate({marginLeft:"1px"},40).animate({marginLeft:"0px"},40).focus()}var c=e("common/module/util.js"),f=$("#userinfo_edit"),m=$("#userinfo_submit"),v=$(".content_txt"),p=$(".input-edit");n.exports=function(){f.on("click",function(){v.hide(),f.hide(),m.show(),i()}),m.on("click",function(){var e=$(this),t=a();if(t){var n=o();if(n){var i=r();if(i){var s=e.text();e.html("正在修改..."),e.attr("disabled","disabled"),XDD.Request({url:"/account/updateBaseInfo",data:{realName:t,contactMobile:n,telephone_number:i},success:function(a){0==a.error_code?(_alert("修改成功！"),$("#txt_name").text(t),$("#txt_phone").text(n),$("#txt_telephone").text(i),p.hide(),v.show(),f.show(),m.hide(),$("#user_info .tip").hide()):_alert(a.error_msg),e.html(s),e.removeAttr("disabled")},error:function(){e.html(s),e.removeAttr("disabled")}})}}}})}});
;/*!/user/widget/view/account_security/select_change_mobile.js*/
define("user/widget/view/account_security/select_change_mobile",function(require,exports,module){var popup=require("common/module/popup/popup.js"),tpl=[function(locals,filters,escape,rethrow){function rethrow(e,s,n,t){var c=s.split("\n"),a=Math.max(t-3,0),i=Math.min(c.length,t+3),r=c.slice(a,i).map(function(e,s){var n=s+a+1;return(n==t?" >> ":"    ")+n+"| "+e}).join("\n");throw e.path=n,e.message=(n||"ejs")+":"+t+"\n"+r+"\n\n"+e.message,e}escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var __stack={lineno:1,input:'<div id="select-box">\n    <img src="<%=__uri(\'../../../../common/static/image/logo.png\')%>" alt="56xdd.com" class="logo"/>\n    <dl>\n        <dd class="clearfix">\n            <a href="/user/changeBind?pass" id="select-pass" class="user-btn">通过输入密码进行修改<em>>></em></a>\n\n        </dd>\n        <dd class="clearfix">\n            <a href="/user/changeBind?sms" id="select-sms" class="user-btn">通过手机验证码进行修改<em>>></em></a>\n        </dd>\n    </dl>\n</div>',filename:"user/widget/view/account_security/select_change_mobile.ejs"};try{var buf=[];with(locals||{})!function(){buf.push('<div id="select-box">\n    <img src="',escape((__stack.lineno=2,"/static/common/static/image/logo_8633d69.png")),'" alt="56xdd.com" class="logo"/>\n    <dl>\n        <dd class="clearfix">\n            <a href="/user/changeBind?pass" id="select-pass" class="user-btn">通过输入密码进行修改<em>>></em></a>\n\n        </dd>\n        <dd class="clearfix">\n            <a href="/user/changeBind?sms" id="select-sms" class="user-btn">通过手机验证码进行修改<em>>></em></a>\n        </dd>\n    </dl>\n</div>')}();return buf.join("")}catch(err){rethrow(err,__stack.input,__stack.filename,__stack.lineno)}}][0],select=function(){function e(){}return e.prototype=new popup({title:!1,height:340,width:330,tpl:tpl}),e.prototype.constructor=e,e.prototype.setHeight=function(e){this.pop.height(e)},new e};module.exports=select});
;/*!/user/widget/view/account_security/account_security.js*/
define("user/widget/view/account_security/account_security",function(c,e,t){function n(){$("html body").on("click","#user-account-security .user-content #change-mobile",function(){u.show()})}var i=c("user/widget/view/account_security/select_change_mobile.js"),u=i();t.exports={init:function(){n()}}});
;/*!/user/widget/view/account_security/change_pass.js*/
define("user/widget/view/account_security/change_pass",function(e,t,n){function a(){function e(e,t){var n=$(e).val(),i=n.length,o=r.isPassword(n);return i?6>i?(a(e),s(e,"密码为6-16位"),!1):o?(s(e,""),n):(a(e),s(e,"密码必须包含字母和数字"),!1):t?(a(e),s(e,"请输入密码"),!1):void 0}function t(e,t,n){var r=$(e).val(),i=$(t).val();return i.length?i!==r?(a(t),s(t,"两次输入密码不一致"),!1):(s(t,""),i):n?(a(t),s(t,"请再次输入密码"),!1):void 0}function n(n,a,r){var s=n,i=e("#new-pass",1);if(i)var o=t("#new-pass","#new-repass",1);i&&o&&XDD.Request({url:"/account/changePwd ",data:{oldPwd:s,newPwd:i},success:function(e){0==e.error_code?(_alert("修改密码成功！"),setTimeout("location.href = '/account/personalInfo'",2e3)):_alert(e.error_msg),a.html(r),a.removeAttr("disabled")},error:function(){a.html(r),a.removeAttr("disabled")}})}function a(e){$(e).animate({marginLeft:"-1px"},40).animate({marginLeft:"2px"},40).animate({marginLeft:"-2px"},40).animate({marginLeft:"1px"},40).animate({marginLeft:"0px"},40).focus()}function s(e,t){var n=$(e).siblings(".tip");$(n).addClass("red").html(t)}$("#new-pass").on("blur",function(){e("#new-pass")}),$("#new-repass").on("blur",function(){t("#new-pass","#new-repass")}),$(".next-step").on("click",function(){var t=$(this),a=e("#pass",1);if(a){var r=t.text();t.html("正在提交..."),t.attr("disabled","disabled"),XDD.Request({url:"/user/validatePwd",data:{pwd:a},success:function(e){0==e.error_code?n(a,t,r):_alert(e.error_msg),t.html(r),t.removeAttr("disabled")},error:function(){t.html(r),t.removeAttr("disabled")}})}})}var r=e("common/module/util.js");n.exports={init:function(){a()}}});
;/*!/user/widget/view/account_security/change_phone.js*/
define("user/widget/view/account_security/change_phone",function(e,s,t){function n(){function e(){"pass"==v?$("#step-one-pass").show():"sms"==v&&$("#step-one-sms").show()}function s(e){var s=$("#step-one-password").val(),t=o.isPassword(s);return s.length?s.length<6?(p("#step-one-password"),void u(".tip-pass","密码为6-16位")):t?($(".tip-pass").html(""),s):(p("#step-one-password"),void u(".tip-pass","密码必须包含字母和数字")):e?void u(".tip","请输入密码"):void 0}function t(){XDD.Request({type:"GET",url:"/user/sendSms",data:{smsType:"NORMAL_AUTH"},success:function(e){if(0==e.error_code){_alert("已向您的手机发送了短信，请注意查收");var s=60,t=function(){1==s?($("#get-sms").html("重发短信"),$("#get-sms").removeClass("disable"),clearTimeout(n)):(s--,$("#get-sms").html("重发("+s+")"),$("#get-sms").addClass("disable"),setTimeout(t,1e3))},n=setTimeout(t,1e3)}else _alert(e.error_msg)}})}function n(e){var s=$("#change-phone-sms").val();return s.length?4!==s.length?(u(".tip-sms","请输入4位短信验证码"),void p("#change-phone-sms")):o.isNumber(s)?($(".tip-sms").html(""),s):(u(".tip-sms","短信验证码为4位数字"),void p("#change-phone-sms")):e?(u(".tip-sms","请输入短信验证码"),void p("#change-phone-sms")):void 0}function i(){$(".nav-one").removeClass("current").addClass("finshed"),$(".nav-two").addClass("current"),$("#step-one-sms").hide(),$("#step-one-pass").hide(),$("#step-two").show()}function r(e){var s=$("#new-mobile").val();return s?11!==s.length?(p("#new-mobile"),void u(".tip-newmobile","请输入11位手机号")):o.isMobilePhone(s)?s:(p("#new-mobile"),void u(".tip-newmobile","请输入正确的手机号")):e?(p("#new-mobile"),void u(".tip-newmobile","请输入手机号")):(p("#new-mobile"),void u(".tip-newmobile","请输入手机号"))}function a(e,s,t){XDD.Request({type:"GET",url:"/index/checkExist",data:{mobileOrName:s},success:function(e){"function"==typeof t&&t(e)}})}function l(){var e=r();XDD.Request({type:"GET",url:"/user/sendSms",data:{mobile:e,smsType:"CHANGE_MOBILE"},success:function(e){if(0==e.error_code){_alert("已向您的手机发送了短信，请注意查收");var s=60,t=function(){1==s?($("#get-new-sms").html("重发短信"),$("#get-new-sms").removeClass("disable"),clearTimeout(n)):(s--,$("#get-new-sms").html("重发("+s+")"),$("#get-new-sms").addClass("disable"),setTimeout(t,1e3))},n=setTimeout(t,1e3)}else _alert(e.error_msg)}})}function m(e){var s=$("#new-phone-sms").val();return s.length?4!==s.length?(u(".tip-newsms","请输入4位短信验证码"),p("#new-phone-sms"),!1):o.isNumber(s)?($(".tip-sms").html(""),s):(u(".tip-newsms","短信验证码为4位数字"),p("#new-phone-sms"),!1):e?(u(".tip-newsms","请输入短信验证码"),void p("#new-phone-sms")):void 0}function d(){$(".nav-two").removeClass("current").addClass("finshed"),$(".nav-three").addClass("current"),$("#step-two").hide(),$("#step-three").show(),c()}function c(){var e=5,s=function(){1==e?(window.location.href="/account/accountSecurity",clearTimeout(t)):(e--,$("#next-step-three").html(e+"S跳转"),setTimeout(s,1e3))},t=setTimeout(s,1e3)}function u(e,s){$(e).html(s),$(e).addClass("red")}function p(e){$(e).animate({marginLeft:"-1px"},40).animate({marginLeft:"2px"},40).animate({marginLeft:"-2px"},40).animate({marginLeft:"1px"},40).animate({marginLeft:"0px"},40).focus()}var h=window.location.href,v=h.split("?")[1];e(),$(".next-step-one").on("click",function(){var e=$(this);if("pass"==v){var t=s(1);if(t){var o=e.text();e.html("正在提交..."),e.attr("disabled","disabled"),XDD.Request({url:"/user/validatePwd",data:{pwd:t},success:function(s){console.log(s),0==s.error_code?i():_alert(s.error_msg),e.html(o),e.removeAttr("disabled")},error:function(){e.html(o),e.removeAttr("disabled")}})}}else if("sms"==v){var r=n(1);if(r){var o=e.text();e.html("正在提交..."),e.attr("disabled","disabled"),XDD.Request({url:"/user/validateSmsCode",type:"GET",data:{code:r,smsType:"NORMAL_AUTH"},success:function(s){console.log(s),0==s.error_code?i():_alert(s.error_msg),e.html(o),e.removeAttr("disabled")},error:function(){e.html(o),e.removeAttr("disabled")}})}}}),$("#get-sms").on("click",function(){var e=$(this).hasClass("disable");e||t()}),$("#get-new-sms").on("click",function(){var e=r();e&&($(".tip-newmobile").html("正在检查手机号可用性..."),a(".tip-newmobile",e,function(e){if(0==e.error_code){u(".tip-newmobile","手机号可用"),$("#new-mobiletip").removeClass("red");var s=$("#get-new-sms").hasClass("disable");if(s)return!1;l()}else u(".tip-newmobile","手机号已被注册（或不可用）"),p("#new-mobile")}))}),$("#next-step-two").on("click",function(){var e=r(1),s=m(1),t=$(this),n=t.text();t.html("正在修改..."),t.attr("disabled","disabled"),e&&s&&XDD.Request({url:"/user/changeBind",data:{code:s,mobile:e,smsType:"CHANGE_MOBILE"},success:function(e){console.log(e),0==e.error_code?(_alert("修改成功!"),d()):_alert(e.error_msg),t.html(n),t.removeAttr("disabled")},error:function(){t.html(n),t.removeAttr("disabled")}})})}var o=e("common/module/util.js");t.exports={init:function(){n()}}});
;/*!/user/widget/view/apply_manager/apply_manager.js*/
define("user/widget/view/apply_manager/apply_manager",function(o,e,n){function l(){$("#upload-licence").AjaxFileUpload({onComplete:function(o,e){console.log(o,e)}}),$("#upload-official").AjaxFileUpload({onComplete:function(o,e){console.log(o,e)}})}o("common/module/upload/uploader.js"),n.exports={init:function(){l()}}});
;/*!/user/widget/view/employee/employee.js*/
define("user/widget/view/employee/employee",function(e,a,i){function l(){var e={groupWindow:$(".group"),groupMsg:$(".group-msg"),groupList:$(".user_group"),groupSubmit:$(".submit-group")},a={allEmployee:$("#all_employee"),applyEmployee:$("#apply_employee"),searchEmployee:$("#search_result"),tab1:$("#tab1"),tab2:$("#tab2"),tab3:$("#tab3"),appealWin:$(".appeal-window"),appeal:$(".appeal"),cancle:$(".cancle"),confirmInvit:$(".invit-confirm"),invitWin:$(".invit-window"),btnInvit:$(".btn-invit")};e.groupMsg.click(function(){var e=$(this);return e.siblings().slideToggle(),!1}),a.appeal.click(function(){var e=$(this);return e.parents().siblings(".appeal-window").show(),!1}),a.confirmInvit.click(function(){var e=$(this);e.parents().siblings(".invit-window").slideToggle()}),a.btnInvit.click(function(){a.invitWin.slideToggle()}),a.cancle.click(function(){a.appealWin.hide()}),e.groupSubmit.click(function(){s()}),a.tab2.on("click",function(){a.allEmployee.hide(),a.tab1.removeClass("cur").addClass("employee-hide"),a.applyEmployee.show(),a.tab2.removeClass("employee-hide").addClass("cur"),a.searchEmployee.hide(),a.tab3.css("background","#eff4f7"),a.tab3.find(".search-li").removeClass("search-li").addClass("search")}),a.tab1.on("click",function(){a.applyEmployee.hide(),a.tab2.removeClass("cur").addClass("employee-hide"),a.allEmployee.show(),a.tab1.removeClass("employee-hide").addClass("cur"),a.searchEmployee.hide(),a.tab3.css("background","#eff4f7"),a.tab3.find(".search-li").removeClass("search-li").addClass("search")}),a.tab3.on("click",function(){a.allEmployee.hide(),a.tab1.removeClass("cur").addClass("employee-hide"),a.applyEmployee.hide(),a.tab2.removeClass("cur").addClass("employee-hide"),a.searchEmployee.show(),a.tab3.find(".search").removeClass("search").addClass("search-li"),a.tab3.css("background","#ffffff")}),$(".apply-header ul li").click(function(){var e=$(this),a=$(this).index();e.addClass("cur").siblings().removeClass("cur"),0==a&&$("#wait_apply").show().siblings().hide(),1==a&&$("#send_apply").show().siblings().hide(),2==a&&$("#recommend_apply").show().siblings().hide()})}function s(){for(var e=$("input[name='group']"),a=0;a<e.length;a++)e[a].checked&&e[a].value}i.exports={init:function(){l()}}});
;/*!/user/widget/view/employee_apply/employee_apply.js*/
define("user/widget/view/employee_apply/employee_apply",function(e,a,c){function l(){var e={checkall:$("#checkall"),_accept:$(".btn-accept"),refuse:$(".btn-refuse"),selectStatus:$(".data-select-status")};e.selectStatus.click(function(){var e=$(this);e.hasClass("apply-data")?(e.removeClass("apply-data").addClass("apply-data-selected"),e.children(".chooese").find(".no-select").removeClass("no-select").addClass("selected").val("已选择")):e.hasClass("apply-data-selected")&&(e.removeClass("apply-data-selected").addClass("apply-data"),e.children(".chooese").find(".selected").removeClass("selected").addClass("no-select").val("选择"))}),e.checkall.click(function(){$("input[name='checkbox']").prop("checked",this.checked)}),$("input[name='checkbox']").click(function(){var e=$("input[name='checkbox']");$("#checkall").prop("checked",e.length==e.filter(":checked").length?!0:!1)}),e._accept.click(function(){var a=$(".apply-data-selected").length;e.selectStatus.each(function(){$(this).hasClass("apply-data-selected")}),0==a&&_alert("请至少选中一项")}),e.refuse.click(function(){})}c.exports={init:function(){l()}}});