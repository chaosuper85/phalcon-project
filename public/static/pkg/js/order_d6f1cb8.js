;/*!/order/module/addSelectTimeBox/addSelectTimeBox.js*/
define("order/module/addSelectTimeBox/addSelectTimeBox",function(e,a,t){function i(e){function a(e){var a={container:e.container||$("body"),addName:e.addName||".add-date",height:e.height||30},t=a.container.$scope||a.container,i=a.addName,n=this.selectTimeBox=[],o=1,d=$('<a class="delTimeBtn" href="javaScript:" title="删除装箱时间"><i class="icon-del-timeBox" data-flag=""></i></a>'),l=t.find(".package_date_selectBox");0!==l.length?(o=l.length,l.each(function(e){var i=e+1;n.push({container:".package_date_selectBox.data_"+i,flag:i,box:new c({wrap:t.find(".package_date_selectBox.data_"+i),level:5,height:a.height}),timeData:{id:t.find(".package_date_selectBox.data_"+i).attr("data-timeId"),can_change:t.find(".package_date_selectBox.data_"+i).attr("data-canChange")||1}})})):n.push({container:".package_date_selectBox.data_1",flag:o,box:new c({wrap:t.find(".package_date_selectBox.data_1"),level:5,height:a.height})}),t.on("click",i,function(){var e=t.find(".package_date_selectBox");if(!(e.length>9)){o++;var i=$(this),d=$('<div class="package_date_selectBox data_'+o+' clearfix" data-flag="'+o+'"></div>');i.before(d),n.push({container:d,flag:o,box:new c({wrap:t.find(".package_date_selectBox.data_"+o),level:5,height:a.height}),timeData:{id:"",can_change:1}})}}),t.on("mouseover",".package_date_selectBox",function(){var e=$(this),a=e.attr("data-flag");1!=a&&(e.append(d),d.show(),d.attr("data-flag",a))}),t.on("mouseleave",".package_date_selectBox",function(){var e=$(this),a=e.attr("data-flag");1!=a&&(e.append(d),d.hide(),d.removeAttr("data-flag"))}),t.on("click",".delTimeBtn",function(){for(var e=$(this),a=e.attr("data-flag"),i=n.length,c=0;i>c;c++)if(n[c].flag==a)return n.splice(c,1),void t.find(".package_date_selectBox.data_"+a).remove()})}return a.prototype.getTimeBox=function(){var e,a=this.selectTimeBox.length,t=[];for(e=0;a>e;e++)t.push(this.selectTimeBox[e].box.val());return t},a.prototype.getTimeBoxId=function(){var e,a=this.selectTimeBox.length,t=[];for(e=0;a>e;e++)t.push({time:this.selectTimeBox[e].box.val(),time_id:this.selectTimeBox[e].timeData.id,can_change:this.selectTimeBox[e].timeData.can_change});return t},new a(e)}var c=e("common/module/selectTimeBox/selectTimeBox.js");t.exports=i});
;/*!/order/widget/view/order_complete/commonBox.js*/
define("order/widget/view/order_complete/commonBox",function(e,r,s){function t(e){var r,s=e.scope||$("body");r="object"==typeof e.config_array?e.config_array:[];for(var t={},a=r.length,v=0;a>v;v++){var d=r[v],u=d.keyName||"",m=d.selector||"",p=d.require,g=d.type||"",O=d.selectPlaceholder||"";selectOptions=d.selectOptions||[],t[u]={},function(e,r,o,a){(a===h.input_type||a===h.weight_type)&&(t[e].$=$(s).find(r),t[e].require=o,t[e].type=a),a===h.select_type&&(t[e].$=new l({container:$(s).find(r),width:500,height:34,options:selectOptions,placeholder:O,onSelectChange:function(e,r,s){s.select.select_box.removeClass("error");var t=i(s.select.select_box);t.error.hide(),c.isNull(e)?t.right.hide():t.right.show()}}),t[e].require=o,t[e].type=a),a===h.address_select_type&&(t[e].$=new n({wrap:r,width:145,level:3,text_align:"center",onProvinceSelectChange:function(e,r,s){e&&s.province.select.select_box.removeClass("error")},onCitySelectChange:function(e,r,s){e&&s.city.select.select_box.removeClass("error")},onAreaSelectChange:function(e,r,s){if(e){s.area.select.select_box.removeClass("error");var t=i(s.area.select.select_box);t.error.hide(),t.right.show()}}}),t[e].require=o,t[e].type=a)}(u,m,p,g)}this.$SCOPE=s,this.DOM=t,o(t,this.$SCOPE)}function o(e,r){for(var s in e){var t=s,o=e[s].require,a=e[s].$,l=e[s].type;!function(e,s,t,o){if(t&&(o===h.input_type&&(r.on("keyup","#"+s.attr("id"),function(){var e=$(this).val(),r=i($(this));$(this).removeClass("error"),c.isNull(e)&&r.right.hide(),c.isNull(e)||(r.error.hide(),r.right.show())}),r.on("blur","#"+s.attr("id"),function(){var e=$(this).val(),r=i($(this));c.isNull(e)?($(this).addClass("error"),r.error.show(),r.right.hide()):($(this).removeClass("error"),r.error.hide(),r.right.show())})),o===h.weight_type)){var a=s.siblings(".decrease"),l=s.siblings(".plus"),n=s.parent("li").parent("ul").find("input");a.on("click",function(){var e=i(s),r=0;s.removeClass("error");try{var t=new Number(s.val())}catch(o){var t=0;return void s.val(0)}c.isNumber(t)&&t>0?(s.val(t-1),r=t-1):s.val(0),r+=t,n.each(function(){var e=$(this);r+=e.val()}),r>0&&(n.removeClass("error"),e.error.hide())}),l.on("click",function(){var e=i(s),r=0;s.removeClass("error");try{var t=new Number(s.val())}catch(o){var t=0;return void s.val(0)}c.isNumber(t)&&t>=0?(s.val(t+1),r=t+1):s.val(0),n.each(function(){var e=$(this);r+=e.val()}),r>0&&(n.removeClass("error"),e.error.hide())}),s.on("keydown",function(e){var r=e.keyCode;r>47&&58>r||8!==r&&c.preventDefault(e)}),s.on("keyup",function(e){var r=e.keyCode,t=0;if(r>47&&58>r&&8!==!r){try{var o=new Number(s.val())}catch(e){return void s.val(0)}t+=o;var a=i(s);!c.isNumber(o)||0>=o||(s.removeClass("error"),n.each(function(){var e=$(this);t+=e.val()}),t>0&&(n.removeClass("error"),a.error.hide()))}})}}(t,a,o,l)}}function a(e){e.animate({marginLeft:"-1px"},40).animate({marginLeft:"2px"},40).animate({marginLeft:"-2px"},40).animate({marginLeft:"1px"},40)}function i(e){var r={message:e.parents(".item-content").siblings(".item-message")};return r.error=r.message.find(".error-message"),r.right=r.message.find(".right-message"),r}var c=e("common/module/util.js"),l=e("common/module/select/select.js"),n=e("common/module/address/address.js"),h={is_require:!0,no_require:!1,input_type:"INPUT",weight_type:"WEIGHT",select_type:"SELECT",address_select_type:"ADDRESS"};t.prototype={check:function(){var e=this,r={};for(var s in e.DOM){var t=s;switch(r[t]={val:e.DOM[t].$.val()},e.DOM[t].type){case h.input_type:var o=i(e.DOM[t].$);e.DOM[t].require&&c.isNull(r[t].val)?(r[t].checkPass=!1,e.DOM[t].$.addClass("error"),a(e.DOM[t].$),e.DOM[t].$.focus(),o.error.show(),o.right.hide()):e.DOM[t].require?(e.DOM[t].$.removeClass("error"),r[t].checkPass=!0,o.error.hide(),o.right.show()):(r[t].checkPass=!0,o.error.hide(),o.right.hide());break;case h.select_type:var o=i(e.DOM[t].$.select.select_box);e.DOM[t].require&&c.isNull(r[t].val)?(r[t].checkPass=!1,e.DOM[t].$.select.select_box.addClass("error"),a(e.DOM[t].$.select.select_box),o.error.show(),o.right.hide()):(e.DOM[t].$.select.select_box.removeClass("error"),r[t].checkPass=!0,o.error.hide(),o.right.show());break;case h.weight_type:var o=i(e.DOM[t].$),l=0,n=e.DOM[t].$.parent("li").parent("ul").find("input");n.each(function(){var e=$(this);l+=e.val()}),c.isNumber(l)&&(0>=l||l>1e6)?(e.DOM[t].$.addClass("error"),r[t].checkPass=!1,a(e.DOM[t].$),e.DOM[t].$.focus(),o.error.show(),o.right.hide()):(e.DOM[t].$.removeClass("error"),r[t].checkPass=!0,o.error.hide(),o.right.show());break;case h.address_select_type:var o=i(e.DOM[t].$.dom.wrap),v=e.DOM[t].$.getProvince().id,d=e.DOM[t].$.getCity().id,u=e.DOM[t].$.getArea().id;v?v&&!d?(e.DOM[t].$.province.select.select.select_box.removeClass("error"),e.DOM[t].$.city.select.select.select_box.addClass("error"),e.DOM[t].$.area.select.select.select_box.addClass("error"),a(e.DOM[t].$.dom.wrap),r[t].checkPass=!1,o.error.show(),o.right.hide()):v&&d&&!u?(e.DOM[t].$.province.select.select.select_box.removeClass("error"),e.DOM[t].$.city.select.select.select_box.removeClass("error"),a(e.DOM[t].$.dom.wrap),r[t].checkPass=!1,e.DOM[t].$.area.select.select.select_box.addClass("error"),o.error.show(),o.right.hide()):(e.DOM[t].$.province.select.select.select_box.removeClass("error"),e.DOM[t].$.city.select.select.select_box.removeClass("error"),e.DOM[t].$.area.select.select.select_box.removeClass("error"),r[t].checkPass=!0,o.error.hide(),o.right.show()):(e.DOM[t].$.province.select.select.select_box.addClass("error"),e.DOM[t].$.city.select.select.select_box.addClass("error"),e.DOM[t].$.area.select.select.select_box.addClass("error"),a(e.DOM[t].$.dom.wrap),r[t].checkPass=!1,o.error.show(),o.right.hide())}}return r}},s.exports=t});
;/*!/order/widget/view/order_complete/addressBox.js*/
define("order/widget/view/order_complete/addressBox",function(require,exports,module){function AddressBox(e){var a={item:e.item||1},s=this.list=[],i=$(CONST.SCOPE+" .address-item"),t=a.item,d=$(CONST.SCOPE+" .add-address"),r=$('<a class="del-AddressBtn" href="javaScript:">删除该地址</a>');$(CONST.SCOPE).on("mouseover",".address-item",function(){var e=$(this),a=e.attr("data-item");1!=s.length&&(r.show(),e.find(".address-del").html(r),r.attr("data-item",a))}),$(CONST.SCOPE).on("mouseleave",".address-item",function(){var e=$(this),a=e.attr("data-item");1!=s.length&&(r.hide(),r.removeAttr("data-item",a))}),$(CONST.SCOPE).on("click",".del-AddressBtn",function(){var e=$(this),a=e.attr("data-item");if(1!=s.length){var i,t=e.parents(".address-item");for(i=0;i<s.length;i++)if(s[i].$scope.attr("data-item")==a){s.splice(i,1);break}t.remove();var d=$(CONST.SCOPE).find(".address-item .address-title .address-name .num");d.each(function(e){$(this).text(e+1)})}}),i.each(function(){var e=$(this),a=(e.find(".address-del"),new AddressItem(e));s.push(a)}),d.on("click",function(){if(!(t>19)){t++;var e=$(this),a=tpl({item:t}),i=$(a);e.before(i);var d=(i.find(".address-del"),new AddressItem(i));s.push(d);var r=$(CONST.SCOPE).find(".address-item .address-title .address-name .num");r.each(function(e){$(this).text(e+1)})}})}function AddressItem(e){function a(e){this.$scope=e;{var a=this;this.itemBox=new CommonBox({scope:e,config_array:[{keyName:"package_location",selector:e.find(".package_location"),require:CONST.is_require,type:CONST.address_select_type},{keyName:"package_address",selector:".package_address",require:CONST.is_require,type:CONST.input_type},{keyName:"linkman",selector:".linkman",require:CONST.is_require,type:CONST.input_type},{keyName:"contact",selector:".contact",require:CONST.is_require,type:CONST.input_type}]}),a.timeBoxEvent=new AddSelectTimeBox({container:a})}}return a.prototype.check=function(){var e=this.itemBox.check();return e.timeList=this.timeBoxEvent.getTimeBox(),e},new a(e)}var util=require("common/module/util.js"),CommonBox=require("order/widget/view/order_complete/commonBox.js"),AddSelectTimeBox=require("order/module/addSelectTimeBox/addSelectTimeBox.js"),tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<dl class="address-item clearfix" data-item=&#39;',"undefined"==typeof item?"":baidu.template._encodeHTML(item),'&#39;><dd class="address-title"><div class="address-name"><h4>产装地址<span class="num">',"undefined"==typeof item?"":baidu.template._encodeHTML(item),'</span></h4></div><div class="address-del"></div></dd><dt class="item package_date clearfix"><div class="item-name"><label for="package_date"><span class="name">装箱时间</span><span class="icon-require">*</span></label></div><div class="item-content"><div class="package_date_selectBox data_1 clearfix" data-flag="1"></div><a class="add-date" href="javaScript:">+增加其它装箱时间</a></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i>装箱时间必填</div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><dt class="item clearfix"><div class="item-name"><label for="package_location"><span class="name">装箱地</span><span class="icon-require">*</span></label></div><div class="item-content"><div class="package_location"></div></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i>装箱地必填</div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><dt class="item clearfix"><div class="item-name"><label for="package_address"><span class="name">详细地址</span><span class="icon-require">*</span></label></div><div class="item-content"><input type="text" value="" class="package_address" id="package_address" name="package_address" /></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i>详细地址必填</div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><dt class="item clearfix"><div class="item-name"><label for="linkman"><span class="name">工厂联系人</span><span class="icon-require">*</span></label></div><div class="item-content"><input type="text" value="" class="linkman" id="linkman" name="linkman" placeholder="请输入工厂联系人"/></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i>工厂联系人必填</div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><dt class="item clearfix"><div class="item-name"><label for="contact"><span class="name">联系方式</span><span class="icon-require">*</span></label></div><div class="item-content"><input type="text" value="" id="contact" class="contact" name="contact" placeholder="请输入联系方式"/></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i>联系方式必填</div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><div class="clearfix address-bottom-line"></div></dl>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],CONST={SCOPE:".address_info",is_require:!0,no_require:!1,input_type:"INPUT",weight_type:"WEIGHT",select_type:"SELECT",address_select_type:"ADDRESS"};AddressBox.prototype.check=function(){var e,a=[],s=this.list.length;for(e=0;s>e;e++)a.push(this.list[e].check());return a},module.exports=AddressBox});
;/*!/order/widget/view/order_complete/order_complete.js*/
define("order/widget/view/order_complete/order_complete",function(e,r,a){function t(e,r){var a=o(r),t={save:$(".order-save")};t.save.on("click",function(){var r=a.fcBox.check(),t=a.shipBox.check(),o=a.productBox.check(),p=a.addressBox.check(),c={},_={},n=e,d={},s={},u=[],m=!0;c.id=r.freight_id.val||"",c.name=r.freight_name.val||"",_.id=r.carteam_id.val||"",_.name=r.carteam_name.val||"",d.ship_company_id=$("#ship_company").attr("data-id")||" ",d.ship_company_name=t.company.val||"",d.ship_name_id=$("#ship_name").attr("data-id")||" ",d.ship_name=t.name.val||"",d.ship_ticket=t.num.val||"",d.yard_id=$("#ship_yard").attr("data-id")||" ",d.yard_name=t.yard.val||"",d.tidan_code=t.tidan.val||"",s.product_box_type=o.product_type.val||"",s.box_type_number=[{number:o["20gp"].val||"",type:"20GP"},{number:o["40gp"].val||"",type:"40GP"},{number:o["40hg"].val||"",type:"40HQ"}],s.product_name=o.product_name.val||"",s.product_weight=o.product_weight.val||"",s.product_notice=o.product_remark.val||"";for(var y=p.length;y--;){var l={};l.box_date=p[y].timeList,l.address_provinceId=p[y].package_location.val.province.id||"",l.address_cityId=p[y].package_location.val.city.id||"",l.address_townId=p[y].package_location.val.area.id||"",l.box_address_detail=p[y].package_address.val||"",l.contactName=p[y].linkman.val,l.contactNumber=p[y].contact.val,u.push(l),m=i(p[y])}return i(r)&&i(t)&&i(o)&&m?void XDD.Request({url:"/carteam/order/confirm",data:{orderid:n,ship_info:d,product_info:s,address_info:u},success:function(e){0===e.error_code?(_alert(e.error_msg||"接单成功！"),window.location.href="/order/list"):_alert(e.error_msg||"未知错误！")}},!0):void _alert("您有信息未填写或填写格式不正确！")})}function i(e){var r=!0;for(var a in e)e[a]&&"boolean"==typeof e[a].checkPass&&!e[a].checkPass&&(r=!1);return r}function o(e){var r,a,t,i;return r=new c({scope:$(".carteam_freight"),config_array:[{keyName:"freight_id",selector:"#freight_id",require:n.no_require,type:n.input_type},{keyName:"freight_name",selector:"#freight_name",require:n.no_require,type:n.input_type},{keyName:"carteam_id",selector:"#carteam_id",require:n.no_require,type:n.input_type},{keyName:"carteam_name",selector:"#carteam_name",require:n.no_require,type:n.input_type}]}),a=new c({scope:$(".ship_info"),config_array:[{keyName:"company",selector:"#ship_company",require:n.is_require,type:n.input_type},{keyName:"tidan",selector:"#tidan",require:n.no_require,type:n.input_type},{keyName:"name",selector:"#ship_name",require:n.is_require,type:n.input_type},{keyName:"num",selector:"#ship_num",require:n.is_require,type:n.input_type},{keyName:"yard",selector:"#ship_yard",require:n.is_require,type:n.input_type}]}),t=new c({scope:$(".product_info"),config_array:[{keyName:"product_type",selector:"#product_type",require:n.input_type,type:n.select_type,selectPlaceholder:"请选择货物箱型",selectOptions:e},{keyName:"20gp",selector:"#product_20gp",require:n.is_require,type:n.weight_type},{keyName:"40gp",selector:"#product_40gp",require:n.is_require,type:n.weight_type},{keyName:"40hg",selector:"#product_40hg",require:n.is_require,type:n.weight_type},{keyName:"product_name",selector:"#product_name",require:n.no_require,type:n.input_type},{keyName:"product_weight",selector:"#product_weight",require:n.is_require,type:n.input_type},{keyName:"product_remark",selector:"#product_remark",require:n.no_require,type:n.input_type}]}),i=new _({item:1}),{fcBox:r,shipBox:a,productBox:t,addressBox:i}}var p=e("common/module/util.js"),c=e("order/widget/view/order_complete/commonBox.js"),_=e("order/widget/view/order_complete/addressBox.js");e("common/module/searchBox/searchBox.js");var n={is_require:!0,no_require:!1,input_type:"INPUT",weight_type:"WEIGHT",select_type:"SELECT"};a.exports={init:function(e,r){var a=[];for(var i in r){var o={value:i,text:r[i]};a.push(o)}$("#ship_company").XDDSearchBox({resKeyName:"china_name",appKeyName:"english_name",keyId:"company_id"}),$("#ship_name").XDDSearchBox({url:"/carteam/order/search_ship_name",resKeyName:"china_name",appKeyName:"eng_name",keyId:"ship_name_id"}),$("#ship_yard").XDDSearchBox({url:"/carteam/order/search_yard",resKeyName:"yard_name",keyId:"yard_id"}),$("#product_weight").on("keydown",function(e){var r=e.keyCode;r>47&&58>r||8!==r&&p.preventDefault(e)}),t(e,a)}}});
;/*!/order/module/comfirm_psw_pop/comfirm_psw_pop.js*/
define("order/module/comfirm_psw_pop/comfirm_psw_pop",function(require,exports,module){function PswConfirmPop(_option){function _PswConfirmPop(){var i=this.pop.find("#confirm_submit"),t=this.pop.find("#quit_confirm"),a=this.pop.find("#quit_captcha"),e=this.pop.find("#quit_tip");this.DOM={submit:i,password:t,captcha:a,tip:e},bind(this)}function bind(i){i.DOM.submit.on("click",function(){var t=checkPass(i);t&&i.onComplete(t)}),$("#passwordConfirm").keydown(function(t){13==t.keyCode&&i.DOM.submit.on()})}function checkPass(i){var t=i.DOM.password.val();return 0==t.length?(i.DOM.tip.html("请输入密码"),i.DOM.tip.removeClass("invisible"),i.DOM.password&&shake(i.DOM.password),void setTimeout(function(){i.DOM.tip.addClass("invisible")},5e3)):t.length<6?(i.DOM.tip.html("密码不少于6位"),i.DOM.tip.removeClass("invisible"),i.DOM.password&&shake(i.DOM.password),void setTimeout(function(){i.DOM.tip.addClass("invisible")},5e3)):(i.DOM.tip.addClass("invisible"),t)}function shake(i){i.animate({marginLeft:"-1px"},40).animate({marginLeft:"2px"},40).animate({marginLeft:"-2px"},40).animate({marginLeft:"1px"},40).animate({marginLeft:"0px"},40).focus()}var html,title,defaults={},options=$.extend({},defaults,_option),tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div id="passwordConfirm"><div class="logo"></div><dl><dd class="clearfix"><input type="password" id="quit_confirm" placeholder="请输入密码" maxlength="16"/><span class="icon-pass"></span></dd><dd id="quit_captcha_wrap" class="clearfix hidden"><input type="text" id="quit_captcha" placeholder="验证码" maxlength="4"/><div class="captcha-wrap"></div></dd></dl><div id="quit_tip" class="invisible"></div><a href="javascript:;" id="confirm_submit">确定</a></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0];return _PswConfirmPop.prototype=new popup({title:!1,height:280,width:330,tpl:tpl}),_PswConfirmPop.prototype.constructor=_PswConfirmPop,_PswConfirmPop.prototype.setHeight=function(i){this.pop.height(i)},_PswConfirmPop.prototype.onComplete=function(){},new _PswConfirmPop}var popup=require("common/module/popup/popup.js");module.exports=PswConfirmPop});
;/*!/order/module/commonBox.js*/
define("order/module/commonBox",function(e,r,s){function t(e){var r,s=e.scope||$("body");r="object"==typeof e.config_array?e.config_array:[];for(var t={},a=r.length,v=0;a>v;v++){var d=r[v],u=d.keyName||"",g=d.selector||"",m=d.require,p=d.type||"",f=d.selectPlaceholder||"";selectOptions=d.selectOptions||[],height=d.height||30,t[u]={},function(e,r,o,a,v){(a===h.input_type||a===h.weight_type)&&(t[e].$=$(s).find(r),t[e].require=o,t[e].type=a),a===h.select_type&&(t[e].$=new l({container:$(s).find(r),width:500,height:v,options:selectOptions,placeholder:f,onSelectChange:function(e,r,s){s.select.select_box.removeClass("error");var t=i(s.select.select_box);t.error.hide(),c.isNull(e)?t.right.hide():t.right.show()}}),t[e].require=o,t[e].type=a),a===h.address_select_type&&(t[e].$=new n({wrap:r,width:145,level:3,height:v,text_align:"center",onProvinceSelectChange:function(e,r,s){e&&s.province.select.select_box.removeClass("error")},onCitySelectChange:function(e,r,s){e&&s.city.select.select_box.removeClass("error")},onAreaSelectChange:function(e,r,s){if(e){s.area.select.select_box.removeClass("error");var t=i(s.area.select.select_box);t.error.hide(),t.right.show()}}}),t[e].require=o,t[e].type=a)}(u,g,m,p,height)}this.$SCOPE=s,this.DOM=t,o(t,this.$SCOPE)}function o(e,r){for(var s in e){var t=s,o=e[s].require,a=e[s].$,l=e[s].type;!function(e,s,t,o){if(t&&(o===h.input_type&&(r.on("keyup","#"+s.attr("id"),function(){var e=$(this).val(),r=i($(this));$(this).removeClass("error"),c.isNull(e)&&r.right.hide(),c.isNull(e)||(r.error.hide(),r.right.show())}),r.on("blur","#"+s.attr("id"),function(){var e=$(this).val(),r=i($(this));c.isNull(e)?($(this).addClass("error"),r.error.show(),r.right.hide()):($(this).removeClass("error"),r.error.hide(),r.right.show())})),o===h.weight_type)){var a=s.siblings(".decrease"),l=s.siblings(".plus"),n=s.parent("li").parent("ul").find("input");a.on("click",function(){var e=i(s),r=0;s.removeClass("error");try{var t=new Number(s.val())}catch(o){var t=0;return void s.val(0)}c.isNumber(t)&&t>0?(s.val(t-1),r=t-1):s.val(0),r+=t,n.each(function(){var e=$(this);r+=e.val()}),r>0&&(n.removeClass("error"),e.error.hide())}),l.on("click",function(){var e=i(s),r=0;s.removeClass("error");try{var t=new Number(s.val())}catch(o){var t=0;return void s.val(0)}c.isNumber(t)&&t>=0?(s.val(t+1),r=t+1):s.val(0),n.each(function(){var e=$(this);r+=e.val()}),r>0&&(n.removeClass("error"),e.error.hide())}),s.on("keydown",function(e){var r=e.keyCode;r>47&&58>r||8!==r&&c.preventDefault(e)}),s.on("keyup",function(e){var r=e.keyCode,t=0;if(r>47&&58>r&&8!==!r){try{var o=new Number(s.val())}catch(e){return void s.val(0)}t+=o;var a=i(s);!c.isNumber(o)||0>=o||(s.removeClass("error"),n.each(function(){var e=$(this);t+=e.val()}),t>0&&(n.removeClass("error"),a.error.hide()))}})}}(t,a,o,l)}}function a(e){e.animate({marginLeft:"-1px"},40).animate({marginLeft:"2px"},40).animate({marginLeft:"-2px"},40).animate({marginLeft:"1px"},40)}function i(e){var r={message:e.parents(".item-content").siblings(".item-message")};return r.error=r.message.find(".error-message"),r.right=r.message.find(".right-message"),r}var c=e("common/module/util.js"),l=e("common/module/select/select.js"),n=e("common/module/address/address.js"),h={is_require:!0,no_require:!1,input_type:"INPUT",weight_type:"WEIGHT",select_type:"SELECT",address_select_type:"ADDRESS"};t.prototype={check:function(){var e=this,r={};for(var s in e.DOM){var t=s;switch(r[t]={val:e.DOM[t].$.val()},e.DOM[t].type){case h.input_type:var o=i(e.DOM[t].$);if(0===o.error.length&&0===o.message.length&&0===o.right.length){r[t].checkPass=!0;break}e.DOM[t].require&&c.isNull(r[t].val)?(r[t].checkPass=!1,e.DOM[t].$.addClass("error"),a(e.DOM[t].$),e.DOM[t].$.focus(),o.error.show(),o.right.hide()):e.DOM[t].require?(e.DOM[t].$.removeClass("error"),r[t].checkPass=!0,o.error.hide(),o.right.show()):(r[t].checkPass=!0,o.error.hide(),o.right.hide());break;case h.select_type:var o=i(e.DOM[t].$.select.select_box);e.DOM[t].require&&c.isNull(r[t].val)?(r[t].checkPass=!1,e.DOM[t].$.select.select_box.addClass("error"),a(e.DOM[t].$.select.select_box),o.error.show(),o.right.hide()):(e.DOM[t].$.select.select_box.removeClass("error"),r[t].checkPass=!0,o.error.hide(),o.right.show());break;case h.weight_type:var o=i(e.DOM[t].$),l=0,n=e.DOM[t].$.parent("li").parent("ul").find("input");n.each(function(){var e=$(this);l+=e.val()}),c.isNumber(l)&&0>=l&&l>1e6?(e.DOM[t].$.addClass("error"),r[t].checkPass=!1,a(e.DOM[t].$),e.DOM[t].$.focus(),o.error.show(),o.right.hide()):(e.DOM[t].$.removeClass("error"),r[t].checkPass=!0,o.error.hide(),o.right.show());break;case h.address_select_type:var o=i(e.DOM[t].$.dom.wrap);if(0===o.error.length||0===o.message.length||0===o.right.length){r[t].checkPass=!0;break}var v=e.DOM[t].$.getProvince().id,d=e.DOM[t].$.getCity().id,u=e.DOM[t].$.getArea().id;v?v&&!d?(e.DOM[t].$.province.select.select.select_box.removeClass("error"),e.DOM[t].$.city.select.select.select_box.addClass("error"),e.DOM[t].$.area.select.select.select_box.addClass("error"),a(e.DOM[t].$.dom.wrap),r[t].checkPass=!1,o.error.show(),o.right.hide()):v&&d&&!u?(e.DOM[t].$.province.select.select.select_box.removeClass("error"),e.DOM[t].$.city.select.select.select_box.removeClass("error"),a(e.DOM[t].$.dom.wrap),r[t].checkPass=!1,e.DOM[t].$.area.select.select.select_box.addClass("error"),o.error.show(),o.right.hide()):(e.DOM[t].$.province.select.select.select_box.removeClass("error"),e.DOM[t].$.city.select.select.select_box.removeClass("error"),e.DOM[t].$.area.select.select.select_box.removeClass("error"),r[t].checkPass=!0,o.error.hide(),o.right.show()):(e.DOM[t].$.province.select.select.select_box.addClass("error"),e.DOM[t].$.city.select.select.select_box.addClass("error"),e.DOM[t].$.area.select.select.select_box.addClass("error"),a(e.DOM[t].$.dom.wrap),r[t].checkPass=!1,o.error.show(),o.right.hide())}}return r}},s.exports=t});
;/*!/order/module/edit_product/edit_product.js*/
define("order/module/edit_product/edit_product",function(require,exports,module){var popup=require("common/module/popup/popup.js"),CommonBox=require("order/module/commonBox.js"),AddSelectTimeBox=require("order/module/addSelectTimeBox/addSelectTimeBox.js"),tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';if(eval(_template_varName),_template_fun_array.push('<div id="editProduct"><div class="editProduct-title clearfix"><div class="editProduct-cancel"><button class="cancelBtn">取消</button></div><div class="title-text">修改产装信息</div><div class="editProduct-comfire"><button class="comfireBtn">确定修改</button></div></div><div class="editProduct-content clearfix">'),list&&0!==list.length){_template_fun_array.push("");for(var i=0;i<list.length;i++){if(_template_fun_array.push('<dl class="address-item clearfix" data-item="',"undefined"==typeof(i+1)?"":baidu.template._encodeHTML(i+1),'" data-change="'),_template_fun_array.push(list[i].address_can_change?"1":"0"),_template_fun_array.push('"><input type="hidden" value="',"undefined"==typeof list[i].product_address_id?"":baidu.template._encodeHTML(list[i].product_address_id),'" name="product_address_id" class="product_address_id"/><dd class="address-title"><div class="address-name"><h4>产装地址<span class="num">',"undefined"==typeof(i+1)?"":baidu.template._encodeHTML(i+1),"</span>"),list[i].address_can_change||_template_fun_array.push('<span class="address_complete">（已运抵，不可修改）</span>'),_template_fun_array.push('</h4></div><div class="address-del"></div></dd>'),list[i].address_can_change?_template_fun_array.push('<dt class="item clearfix"><div class="item-name"><label for="package_location"><span class="name">装箱地</span><span class="icon-require">*</span></label></div><div class="item-content"><div class="package_location" data-pid="',"undefined"==typeof list[i].address_provinceid?"":baidu.template._encodeHTML(list[i].address_provinceid),'" data-cid="',"undefined"==typeof list[i].address_cityid?"":baidu.template._encodeHTML(list[i].address_cityid),'" data-aid="',"undefined"==typeof list[i].address_townid?"":baidu.template._encodeHTML(list[i].address_townid),'"></div></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><dt class="item clearfix"><div class="item-name"><label for="package_address"><span class="name">详细地址</span><span class="icon-require">*</span></label></div><div class="item-content"><input type="text" class="package_address" id="package_address" name="package_address" value="',"undefined"==typeof(list[i].box_address||"")?"":baidu.template._encodeHTML(list[i].box_address||""),'" /></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt>'):_template_fun_array.push('<dt class="item clearfix"><div class="item-name"><label for="package_location"><span class="name">详细装箱地址</span></label></div><div class="item-content"><p>',"undefined"==typeof list[i].box_address_detail?"":baidu.template._encodeHTML(list[i].box_address_detail),"</p></div></dt>"),_template_fun_array.push('<div class="clearfix"><dt class="item item-linkman"><div class="item-name"><label for="linkman"><span class="name">工厂联系人</span></label></div><div class="item-content">'),list[i].address_can_change?_template_fun_array.push('<input type="text" class="linkman" id="linkman" name="linkman" value="',"undefined"==typeof(list[i].contactName||"")?"":baidu.template._encodeHTML(list[i].contactName||""),'" />'):_template_fun_array.push("<p>","undefined"==typeof(list[i].contactName||"未填写")?"":baidu.template._encodeHTML(list[i].contactName||"未填写"),"</p>"),_template_fun_array.push('</div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><dt class="item item-contact"><div class="item-name"><label for="contact"><span class="name">联系方式</span></label></div><div class="item-content">'),list[i].address_can_change?_template_fun_array.push('<input type="text" id="contact" class="contact" name="contact" value="',"undefined"==typeof(list[i].contactNumber||"")?"":baidu.template._encodeHTML(list[i].contactNumber||""),'"/>'):_template_fun_array.push("<p>","undefined"==typeof(list[i].contactNumber||"未填写")?"":baidu.template._encodeHTML(list[i].contactNumber||"未填写"),"</p>"),_template_fun_array.push('</div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt></div><dt class="item package_date clearfix"><div class="item-name"><label for="package_date"><span class="name">装箱时间</span><span class="icon-require">*</span></label></div><div class="item-content">'),list[i].box_date&&0!==list[i].box_date){_template_fun_array.push("");var flag=1;_template_fun_array.push("");for(var d=0;d<list[i].box_date.length;d++)_template_fun_array.push(""),list[i].box_date[d].time_can_change?_template_fun_array.push('<div class="package_date_selectBox data_',"undefined"==typeof flag?"":baidu.template._encodeHTML(flag),' clearfix" data-flag="',"undefined"==typeof flag?"":baidu.template._encodeHTML(flag),'" data-timeId="',"undefined"==typeof list[i].box_date[d].product_time_id?"":baidu.template._encodeHTML(list[i].box_date[d].product_time_id),'" data-time="',"undefined"==typeof list[i].box_date[d].product_supply_time?"":baidu.template._encodeHTML(list[i].box_date[d].product_supply_time),'" data-canChange="1"></div>'):_template_fun_array.push('<div class="package_date_selectBox data_',"undefined"==typeof flag?"":baidu.template._encodeHTML(flag),' clearfix hidden" data-flag="',"undefined"==typeof flag?"":baidu.template._encodeHTML(flag),'" data-timeId="',"undefined"==typeof list[i].box_date[d].product_time_id?"":baidu.template._encodeHTML(list[i].box_date[d].product_time_id),'" data-time="',"undefined"==typeof list[i].box_date[d].product_supply_time?"":baidu.template._encodeHTML(list[i].box_date[d].product_supply_time),'" data-canChange="0"></div><p>',"undefined"==typeof list[i].box_date[d].product_supply_time?"":baidu.template._encodeHTML(list[i].box_date[d].product_supply_time),"</p>"),_template_fun_array.push(""),flag+=1,_template_fun_array.push("");_template_fun_array.push("")}else _template_fun_array.push('<div class="package_date_selectBox data_1 clearfix" data-flag="1"></div>');_template_fun_array.push('<a class="add-date" href="javaScript:">+增加其它装箱时间</a></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><div class="clearfix address-bottom-line"></div></dl>')}_template_fun_array.push("")}else _template_fun_array.push('<dl class="address-item clearfix" data-item="1" data-change="1"><input type="hidden" value="" name="product_address_id" class="product_address_id"/><dd class="address-title"><div class="address-name"><h4>产装地址<span class="num">1</span></h4></div><div class="address-del"></div></dd><dt class="item clearfix"><div class="item-name"><label for="package_location"><span class="name">装箱地</span><span class="icon-require">*</span></label></div><div class="item-content"><div class="package_location"></div></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><dt class="item clearfix"><div class="item-name"><label for="package_address"><span class="name">详细地址</span><span class="icon-require">*</span></label></div><div class="item-content"><input type="text" value="" class="package_address" id="package_address" name="package_address" /></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><div class="clearfix"><dt class="item item-linkman"><div class="item-name"><label for="linkman"><span class="name">工厂联系人</span></label></div><div class="item-content"><input type="text" value="" class="linkman" id="linkman" name="linkman" /></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><dt class="item item-contact"><div class="item-name"><label for="contact"><span class="name">联系方式</span></label></div><div class="item-content"><input type="text" value="" id="contact" name="contact" class="contact" /></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt></div><dt class="item package_date clearfix"><div class="item-name"><label for="package_date"><span class="name">装箱时间</span><span class="icon-require">*</span></label></div><div class="item-content"><div class="package_date_selectBox data_1 clearfix" data-flag="1" data-canChange="1"></div><a class="add-date" href="javaScript:">+增加其它装箱时间</a></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><div class="clearfix address-bottom-line"></div></dl>');_template_fun_array.push(' <button class="add-other-address">添加其他产装地址</button></div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],addTpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<dl class="address-item clearfix" data-item="',"undefined"==typeof flag?"":baidu.template._encodeHTML(flag),'" data-change="1"><input type="hidden" value="" name="product_address_id" class="product_address_id"/><dd class="address-title"><div class="address-name"><h4>产装地址<span class="num">',"undefined"==typeof flag?"":baidu.template._encodeHTML(flag),'</span></h4></div><div class="address-del"></div></dd><dt class="item clearfix"><div class="item-name"><label for="package_location"><span class="name">装箱地</span><span class="icon-require">*</span></label></div><div class="item-content"><div class="package_location"></div></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><dt class="item clearfix"><div class="item-name"><label for="package_address"><span class="name">详细地址</span><span class="icon-require">*</span></label></div><div class="item-content"><input type="text" value="" class="package_address" id="package_address" name="package_address" /></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><div class="clearfix"><dt class="item item-linkman"><div class="item-name"><label for="linkman"><span class="name">工厂联系人</span><span class="icon-require">*</span></label></div><div class="item-content"><input type="text" value="" class="linkman" id="linkman" name="linkman" /></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><dt class="item item-contact"><div class="item-name"><label for="contact"><span class="name">联系方式</span><span class="icon-require">*</span></label></div><div class="item-content"><input type="text" value="" id="contact" name="contact" class="contact" /></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt></div><dt class="item package_date clearfix"><div class="item-name"><label for="package_date"><span class="name">装箱时间</span><span class="icon-require">*</span></label></div><div class="item-content"><div class="package_date_selectBox data_1 clearfix" data-flag="1"></div><a class="add-date" href="javaScript:">+增加其它装箱时间</a></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i></div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><div class="clearfix address-bottom-line"></div></dl>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],CONST={is_require:!0,no_require:!1,input_type:"INPUT",weight_type:"WEIGHT",select_type:"SELECT",address_select_type:"ADDRESS"},EditProduct=function(e){function a(){}function i(e){function a(e){this.$scope=e;{var a=this;this.itemBox=new CommonBox({scope:e,config_array:[{keyName:"package_location",selector:e.find(".package_location"),require:CONST.is_require,type:CONST.address_select_type,height:23},{keyName:"product_address_id",selector:".product_address_id",require:CONST.no_require,type:CONST.input_type},{keyName:"package_address",selector:".package_address",require:CONST.is_require,type:CONST.input_type},{keyName:"linkman",selector:".linkman",require:CONST.is_require,type:CONST.input_type},{keyName:"contact",selector:".contact",require:CONST.is_require,type:CONST.input_type}]}),a.timeBoxEvent=new AddSelectTimeBox({container:a,height:23})}}return a.prototype.check=function(){var e=this.itemBox.check();return e.timeList=this.timeBoxEvent.getTimeBoxId(),e},new a(e)}var s={data:{addressInfo:[],orderid:""}},t=$.extend({},s,e);return a.prototype=new popup({title:!1,height:500,width:700}),a.prototype.constructor=a,a.prototype.init=function(e){var a=(this.list=[],1),s=this,d=tpl({list:e||t.data.addressInfo});this.setContent(d);var n=this.DOM={scope:this.pop.find(".editProduct-content"),del_AddressBtn:$('<a class="del-AddressBtn" href="javaScript:">删除该地址</a>'),item:this.pop.find(".editProduct-content .address-item")};n.item.each(function(){var e=$(this),a=new i(e);s.list.push(a)}),a=this.flag=n.item.length,n.scope.on("click",".add-other-address",function(){if(!(a>19)){a++;var e=$(this),t=addTpl({flag:a}),d=$(t);e.before(d);var c=(d.find(".address-del"),new i(d));s.list.push(c);var l=n.scope.find(".address-item .address-title .address-name .num");l.each(function(e){$(this).text(e+1)})}}),n.scope.on("mouseover",".address-item",function(){var e=$(this),a=e.attr("data-item"),i=e.attr("data-change");1!=a&&i&&0!=i&&(n.del_AddressBtn.show(),e.find(".address-del").html(n.del_AddressBtn),n.del_AddressBtn.attr("data-item",a))}),n.scope.on("mouseleave",".address-item",function(){var e=$(this),a=e.attr("data-item");1!=a&&(n.del_AddressBtn.hide(),n.del_AddressBtn.removeAttr("data-item",a))}),n.scope.on("click",".del-AddressBtn",function(){var e=$(this),a=e.attr("data-item");if(1!=a){var i,t=e.parents(".address-item"),d=s.list.length;for(i=0;d>i;i++)if(s.list[i]&&s.list[i].$scope){var c=s.list[i].$scope.attr("data-item");c==a&&s.list.splice(i,1)}t.remove();var l=n.scope.find(".address-item .address-title .address-name .num");l.each(function(e){$(this).text(e+1)})}})},a.prototype.bind=function(){var e=this,a={cancelBtn:e.pop.find(".editProduct-cancel .cancelBtn"),comfireBtn:e.pop.find(".editProduct-comfire .comfireBtn")};a.cancelBtn.on("click",function(){e.hide()}),a.comfireBtn.on("click",function(){var a,i=[],s=!0,d=e.list.length;for(a=0;d>a;a++){var n=e.list[a].check(),c={};if(c.product_address_id=n.product_address_id.val||"",n.package_location.val.province.id&&n.package_location.val.city.id&&n.package_location.val.area.id){var l={address:n.package_address.val};l.provinceid=n.package_location.val.province.id,l.cityid=n.package_location.val.city.id,l.townid=n.package_location.val.area.id}c.contactName=n.linkman.val,c.contactNumber=n.contact.val,c.box_date=[],l&&(c.box_address=l);for(var r=n.timeList.length;r--;){var o={product_time_id:n.timeList[r].time_id};1==n.timeList[r].can_change&&(o.product_supply_time=n.timeList[r].time),c.box_date.push(o)}i.push(c);for(var p in n)n&&"boolean"==typeof n[p].checkPass&&!n[p].checkPass&&(console.log(p),s=!1)}s&&XDD.Request({url:"/carteam/order/address_confirm",data:{address_info:i,orderid:t.data.orderid},success:function(a){0==a.error_code?(e.hide(),_alert(a.error_msg||"修改成功！"),window.location.reload()):_alert(a.error_msg||"未知错误！")}},!0)})},new a};module.exports=EditProduct});
;/*!/order/module/confirm_product/confirm_product.js*/
define("order/module/confirm_product/confirm_product",function(require,exports,module){var popup=require("common/module/popup/popup.js"),tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';if(eval(_template_varName),_template_fun_array.push('<div id="confirmProduct"><div class="confirmProduct-title clearfix"><div class="confirmProduct-edit"><button class="editBtn">修改</button></div><div class="title-text">请确认装货地址及时间信息无误再进行分配调度</div><div class="confirmProduct-comfire"><button class="comfireBtn">确定</button></div></div><div class="confirmProduct-content clearfix">'),list&&0!==list.length){_template_fun_array.push("");for(var i=0;i<list.length;i++){if(_template_fun_array.push('<dl class="address-item clearfix" data-item="',"undefined"==typeof(i+1)?"":baidu.template._encodeHTML(i+1),'"><dd class="address-title"><div class="address-name"><h4>产装地址<span class="num">',"undefined"==typeof(i+1)?"":baidu.template._encodeHTML(i+1),'</span></h4></div><div class="address-del"></div></dd><dt class="item clearfix"><div class="item-name"><label><span class="name">装箱地址</span></label></div><div class="item-content">',"undefined"==typeof list[i].box_address_detail?"":baidu.template._encodeHTML(list[i].box_address_detail),'</div></dt><div class="clearfix"><dt class="item item-linkman"><div class="item-name"><label><span class="name">工厂联系人</span></label></div><div class="item-content">',"undefined"==typeof list[i].contactName?"":baidu.template._encodeHTML(list[i].contactName),'</div></dt><dt class="item item-contact"><div class="item-name"><label><span class="name">联系方式</span></label></div><div class="item-content">',"undefined"==typeof list[i].contactNumber?"":baidu.template._encodeHTML(list[i].contactNumber),'</div></dt></div><dt class="item package_date clearfix"><div class="item-name"><label><span class="name">装箱时间</span></label></div><div class="item-content">'),list[i].box_date&&0!==list[i].box_date){_template_fun_array.push("");for(var d=0;d<list[i].box_date.length;d++)_template_fun_array.push("<p>","undefined"==typeof list[i].box_date[d].product_supply_time?"":baidu.template._encodeHTML(list[i].box_date[d].product_supply_time),"</p>");_template_fun_array.push("")}else _template_fun_array.push("<p>未添加装箱时间</p>");_template_fun_array.push("</div></dt>"),list.length!=i+1&&_template_fun_array.push('<div class="clearfix address-bottom-line"></div>'),_template_fun_array.push("</dl>")}_template_fun_array.push("")}else _template_fun_array.push('<dl class="address-item clearfix" data-item="1"><dd class="address-title"><div class="address-name"><h4>未添加产装信息！</h4></div></dd></dl>');_template_fun_array.push("</div></div>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],ConfirmProduct=function(t){function e(){var t=tpl({list:i.data.addressInfo});this.setContent(t);var e=this.DOM={editBtn:this.pop.find(".confirmProduct-edit .editBtn"),comfireBtn:this.pop.find(".confirmProduct-comfire .comfireBtn")},a=this;e.editBtn.on("click",function(){a.hide(),"function"==typeof i.clickEditBtn&&i.clickEditBtn()}),e.comfireBtn.on("click",function(){a.hide(),"function"==typeof i.clickConfirmBtn&&i.clickConfirmBtn()})}var a={clickEditBtn:function(){},clickConfirmBtn:function(){}},i=$.extend({},a,t);return e.prototype=new popup({title:!1,height:500,width:700,isNotCloseIcon:!0}),e.prototype.constructor=e,new e};module.exports=ConfirmProduct});
;/*!/order/widget/view/order_details/order_details.js*/
define("order/widget/view/order_details/order_details",function(o,t,e){function r(o,t,e){var r=new s,c=new n({width:500}),a={$scope:$("#order_details"),btnModify:$("#modify_productInfo"),btnQuit:$("#quit_order"),btnDispatch:$("#btn_dispatch"),btnRebuild:$("#reconstruct_order"),funcs_control:$("#order_details .funcs.control"),funcs_look:$("#order_details .funcs.look"),dispatch_info:$("#order_details .dispatch-info")},f=i({data:{addressInfo:o,orderid:t}}),u=d({data:{addressInfo:o,orderid:t},clickEditBtn:function(){f.init(),f.bind(),f.show()},clickConfirmBtn:function(){a.funcs_control.show(),a.funcs_look.hide(),a.dispatch_info.addClass("dispatch-editing-info")}});e&&1==e?u.show():e&&2==e?(a.funcs_control.show(),a.funcs_look.hide(),a.dispatch_info.addClass("dispatch-editing-info")):(a.funcs_control.hide(),a.funcs_look.show(),a.dispatch_info.removeClass("dispatch-editing-info")),a.btnModify.click(function(){f.init(),f.bind(),f.show()}),a.btnQuit.click(function(){r.show(),r.onComplete=function(o){XDD.Request({url:"/carteam/order/reConstruct_verify",data:{orderid:t,password:o},type:"get",success:function(o){r.hide(),0==o.error_code?(_alert("退载成功！"),window.location.href="/order/details?orderid="+t):_alert(o.error_msg||"退载失败！")}})}});var l;a.$scope.on("mouseover",".order-info .second-title .edit-records a",function(o){var t=$(this),e=function(t){var e=t.parent(".edit-records").attr("data-orderid"),r="";c.hide(),XDD.Request({url:"/carteam/order/modify_history",type:"get",data:{orderid:e},success:function(t){if(0==t.error_code){var e,i=t.data.length;if(i>0)for(e=0;i>e;e++)r+="<p>"+t.data[e].date+'</p><p><span style="margin-right:5px;">'+t.data[e].user+"</span>"+t.data[e].operateType+'</p><p style="margin-bottom:15px;">'+t.data[e].content+"</p>";else r='<p style="text-align:center;">暂无修改记录！</p>';c.setContent(r),c.show(o)}else c.setContent(r),c.show(o)}})};l=setTimeout(function(){e(t)},800)}).on("mouseleave",".order-info .second-title .edit-records",function(){clearTimeout(l),c.hide()}),a.btnDispatch.click(function(){u.show()})}var i=o("order/module/edit_product/edit_product.js"),d=o("order/module/confirm_product/confirm_product.js"),n=o("common/module/cards/cards.js"),s=o("order/module/comfirm_psw_pop/comfirm_psw_pop.js");e.exports={init:function(o,t,e){r(o,t,e)}}});
;/*!/order/module/ensupe_pop/ensupe_pop.js*/
define("order/module/ensupe_pop/ensupe_pop",function(require,exports,module){function EnsupePop(e){function t(e){this.type=e.type,this.DOM={};this.DOM={title:this.pop.find(".editBoxNum-title .title-text"),comfireBtn:this.pop.find(".editBoxNum-title .editBoxNum-comfire .comfireBtn"),cancelBtn:this.pop.find(".editBoxNum-title .editBoxNum-cancel .cancelBtn"),boxId:this.pop.find(".editBoxNum-items #editBoxNum-box-id"),boxNum:this.pop.find(".editBoxNum-items #editBoxNum-box-num"),sealNum:this.pop.find(".editBoxNum-items #editBoxNum-seal-num")},o(this);var t=this;this.DOM.cancelBtn.on("click",function(){t.hide()}),this.DOM.comfireBtn.on("click",function(){i(t)})}function o(e){e.DOM.title.text(a),e.DOM.boxId.val(l.data.id),e.DOM.boxNum.val(l.data.boxNum),e.DOM.sealNum.val(l.data.sealNum)}function i(e){var t,o,i;if("add"===e.type){var t="/carteam/order/save_box_ensupe";o={box_code:e.DOM.boxNum.val(),box_ensupe:e.DOM.sealNum.val(),order_box_id:e.DOM.boxId.val(),order_freight_id:l.data.orderId},i="上传成功！"}else{var t="/carteam/order/save_box_ensupe";o={order_box_id:e.DOM.boxId.val(),box_code:e.DOM.boxNum.val(),box_ensupe:e.DOM.sealNum.val(),order_freight_id:l.data.orderId},i="修改成功！"}XDD.Request({url:t,data:o,success:function(t){0==t.error_code?(e.hide(),_alert(i),"function"==typeof e.onComplete&&e.onComplete(o)):_alert(t.error_msg||"未知错误！")}},!0)}var a,d={data:{id:"",boxNum:"",sealNum:"",orderId:""},type:"add"},l=$.extend({},d,e);return a="add"===l.type?"上传箱号/铅封号":"修改箱号/铅封号",t.prototype=new popup({height:300,width:700,tpl:tpl}),t.prototype.constructor=t,t.prototype.setAdd=function(e){type=this.type="add",a="上传箱号/铅封号",this.DOM.title.text(a),this.DOM.boxId.val(e.boxId),this.DOM.boxNum.val(""),this.DOM.sealNum.val("")},t.prototype.setEdit=function(e){e.boxId&&e.boxNum&&e.sealNum&&(type=this.type="edit",a="修改箱号/铅封号",this.DOM.title.text(a),this.DOM.boxId.val(e.boxId),this.DOM.boxNum.val(e.boxNum),this.DOM.sealNum.val(e.sealNum))},t.prototype.onComplete=function(){},new t(l)}var popup=require("common/module/popup/popup.js"),tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div id="editBoxNum"><div class="editBoxNum-title clearfix"><div class="editBoxNum-cancel"><button class="cancelBtn">取消</button></div><div class="title-text">上传箱号/铅封号</div><div class="editBoxNum-comfire"><button class="comfireBtn">确定</button></div></div><dl class="editBoxNum-items clearfix"><dd class="item"><div class="item-name"><label for="editBoxNum-box-num">箱号：</label></div><div class="item-content"><input type="hidden" id="editBoxNum-box-id" name="editBoxNum-box-id" value="" /><input type="text" placeholder="请输入箱号" id="editBoxNum-box-num" name="editBoxNum-box-num" value="" /></div></dd><dd class="item"><div class="item-name"><label for="editBoxNum-seal-num">铅封号：</label></div><div class="item-content"><input type="text" placeholder="请输入铅封号" id="editBoxNum-seal-num" name="editBoxNum-seal-num" value="" /></div></dd></dl></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0];module.exports=EnsupePop});
;/*!/order/module/assign_pop/assign_pop.js*/
define("order/module/assign_pop/assign_pop",function(require,exports,module){function AssignPop(e){function t(){{var e=(this.type=_.type,this.flag=0);this.DOM={}}this.DOM={title:this.pop.find(".assignPop-title .title-text"),comfireBtn:this.pop.find(".assignPop-title .assignPop-comfire .comfireBtn"),cancelBtn:this.pop.find(".assignPop-title .assignPop-cancel .cancelBtn"),addBtn:this.pop.find("#assignPop .add-other-BoxInfo"),delBtn:$('<a class="del-btn" href="javaScript:">删除</a>'),driver:this.pop.find("#driver-selector"),items_container:this.pop.find(".assignPop-address-info"),items_complete_container:this.pop.find(".assignPop-address-complete-info"),items:this.pop.find(".assign-adrress-items")},this.can_open=_.can_open,this.msg=_.msg,this.driverSelector,this.address_list=[],e=this.DOM.items.length,this.init_popup();var t=this;this.DOM.addBtn.on("click",function(){0==e&&(e=1),e++;var d=($(this),$(item_tpl({flag:e,assign_driver_id:"",order_product_addressid:"",order_product_timeid:"",canChange:!0})));t.DOM.items_container.append(d);var i=new select({width:380,container:d.find(".boxData-selector"),options:[],defaultText:"请先选择装箱地址",defaultValue:"0",options_max_height:160,onSelectChange:function(e,t,d){d.select.select_box.removeClass("error")}}),s=new select({width:380,container:d.find(".boxAddress-selector"),options:a,defaultText:"请选择装箱地址",defaultValue:"0",onSelectChange:function(e,t,d){d.select.select_box.removeClass("error"),i.setSelectedVal(""),i.setSelectedText("请先选择装箱地址"),i.setOptions([]),function(e){o=[];for(var t=0;t<_.select_options.length;t++)if(e==_.select_options[t].product_address_id)for(var d=_.select_options[t].box_date,i=0;i<d.length;i++)o.push({value:d[i].product_time_id,text:d[i].product_supply_time})}(e),i.setSelectedText("请选择装箱时间"),i.setOptions(o)}});t.address_list.push({address:s,time:i,assign_id:d.find("input[name='assign_driver_id']"),order_product_addressid:d.find("input[name='order_product_addressid']"),order_product_timeid:d.find("input[name='order_product_timeid']"),flag:e})}),this.pop.on("mouseover",".assign-adrress-items",function(){var e=$(this),d=e.attr("data-flag"),i=e.find(".assign-delContainer");1!=d&&(i.html(t.DOM.delBtn),t.DOM.delBtn.show(),t.DOM.delBtn.attr("data-flag",d))}),this.pop.on("mouseleave",".assign-adrress-items",function(){t.DOM.delBtn.hide(),t.DOM.delBtn.removeAttr("data-flag")}),this.pop.on("click",".del-btn",function(){var e,d=$(this),i=d.attr("data-flag");if(1!=i&&0!=t.address_list.length){for(e=0;e<t.address_list.length;e++)i==t.address_list[e].flag&&t.address_list.splice(e,1);d.parents(".assign-adrress-items").remove()}}),this.DOM.comfireBtn.on("click",function(){d(t)}),this.DOM.cancelBtn.on("click",function(){t.hide()})}function d(e){var t=e.driverSelector.val(),d=function(e){var t=e.indexOf("/"),d=e.substring(0,t),i=e.substring(t+1,e.length);return{driver_name:d,car_num:i}}(e.driverSelector.text()),r={driver_info:{driver_id:t,driver_name:d.driver_name,car_num:d.car_num},address_info:[]};if(!t||0==t)return e.driverSelector.select.select_box.addClass("error"),void s(e.driverSelector.select.select_box);var a=i(e.address_list);if(a&&0!==a.length){var o,n=a.length;for(o=0;n>o;o++)a[o].driver_user_id=t,a[o].order_freight_boxid=_.data.id,a[o].order_freight_id=_.data.orderId,r.address_info.push({product_address_id:a[o].order_product_addressid,box_address_detail:a[o].order_product_address_text,product_time_id:a[o].order_product_timeid,box_time:a[o].order_product_time_text}),delete a[o].order_product_address_text,delete a[o].order_product_time_text,a[o].assign_id||delete a[o].assign_id,a[o].order_product_addressid||delete a[o].order_product_addressid,a[o].order_product_timeid||delete a[o].order_product_timeid;XDD.Request({url:"/carteam/order/assign_edit_save",data:{order_assign_info:a},success:function(t){0==t.error_code?(e.hide(),_alert(l),"function"==typeof e.onComplete&&e.onComplete(r)):(e.hide(),_alert(t.error_msg||"未知错误！"))}},!0)}}function i(e){var t,d=e.length,i=!0,r=[];for(t=0;d>t;t++)e[t].address&&e[t].address?e[t].address.val()&&0!=e[t].address.val()?e[t].time.val()&&0!=e[t].time.val()?r.push({order_product_addressid:e[t].address.val(),order_product_address_text:e[t].address.text(),order_product_timeid:e[t].time.val(),order_product_time_text:e[t].time.text(),assign_id:e[t].assign_id.val()}):(e[t].time.select.select_box.addClass("error"),s(e[t].time.select.select_box),i=!1):(e[t].address.select.select_box.addClass("error"),s(e[t].address.select.select_box),i=!1):r.push({order_product_addressid:e[t].order_product_addressid.val(),order_product_timeid:e[t].order_product_timeid.val(),order_product_address_text:"",order_product_time_text:"",assign_id:e[t].assign_id.val()});return i?r:i?void 0:!1}function s(e){e.animate({marginLeft:"-1px"},40).animate({marginLeft:"2px"},40).animate({marginLeft:"-2px"},40).animate({marginLeft:"1px"},40)}var r,a=[],o=[],n={data:{id:"",carTeam_id:"",address_info:[]},carTeam_id:"",select_options:[],type:"add",can_open:!1,msg:"未加载完数据，请重试！"},_=$.extend({},n,e);if("add"===_.type){r="添加司机/装箱信息";var l="添加成功！"}else{r="修改司机/装箱信息";var l="修改成功！"}return function(){for(var e=0;e<_.select_options.length;e++)a.push({value:_.select_options[e].product_address_id,text:_.select_options[e].box_address_detail})}(),t.prototype=new popup({height:550,width:700,tpl:tpl}),t.prototype.constructor=t,t.prototype.setAdd=function(e){flag=this.flag=1,type=this.type="add",r="添加司机/装箱信息",l="添加成功！",this.address_list=[],this.DOM.items_container.html(""),this.DOM.items_complete_container.html(""),this.driverSelector.setSelectedText("请选择司机"),this.driverSelector.setSelectedVal(""),this.pop.find(".driver-name").text("").hide(),this.DOM.driver.show();var t=$(item_tpl({flag:flag,canChange:!0,assign_driver_id:"",order_product_addressid:"",order_product_timeid:""}));this.DOM.items_container.html(t);var d=new select({width:380,container:t.find(".boxData-selector"),options:[],defaultText:"请先选择装箱地址",defaultValue:"0",options_max_height:160,onSelectChange:function(e,t,d){d.select.select_box.removeClass("error")}}),i=new select({width:380,container:t.find(".boxAddress-selector"),options:a,defaultText:"请选择装箱地址",defaultValue:"0",onSelectChange:function(e,t,i){i.select.select_box.removeClass("error"),d.setSelectedVal(""),d.setSelectedText("请先选择装箱地址"),d.setOptions([]),function(e){o=[];for(var t=0;t<_.select_options.length;t++)if(e==_.select_options[t].product_address_id)for(var d=_.select_options[t].box_date,i=0;i<d.length;i++)o.push({value:d[i].product_time_id,text:d[i].product_supply_time})}(e),d.setSelectedText("请选择装箱时间"),d.setOptions(o)}});this.address_list.push({address:i,time:d,assign_id:t.find("input[name='assign_driver_id']"),order_product_addressid:t.find("input[name='order_product_addressid']"),order_product_timeid:t.find("input[name='order_product_timeid']"),flag:flag}),_.data.id=e},t.prototype.setEdit=function(e){var t=this;if(type=t.type="edit",r="修改司机/装箱信息",l="修改成功！",this.address_list=[],t.DOM.items_container.html(""),t.DOM.items_complete_container.html(""),t.driverSelector.setSelectedText(e.driver_info.name+"/"+e.driver_info.car_number),t.driverSelector.setSelectedVal(e.driver_info.id),"boolean"!=typeof e.driver_info.driver_can_change||e.driver_info.driver_can_change?(t.pop.find(".driver-name").text(e.driver_info.name).hide(),t.DOM.driver.show()):(t.pop.find(".driver-name").text(e.driver_info.name).show(),t.DOM.driver.hide()),0==e.address_info.length){flag=t.flag=1;var d=$(item_tpl({flag:flag,canChange:!0,assign_driver_id:"",order_product_timeid:""}));t.DOM.items_container.html(d);var i=new select({width:380,container:d.find(".boxData-selector"),options:[],defaultText:"请选择装箱时间",defaultValue:"0",options_max_height:160,onSelectChange:function(e,t,d){d.select.select_box.removeClass("error")}}),s=new select({width:380,container:d.find(".boxAddress-selector"),options:a,defaultText:"请选择装箱地址",defaultValue:"0",onSelectChange:function(e,t,d){d.select.select_box.removeClass("error"),i.setSelectedVal(""),i.setSelectedText("请先选择装箱地址"),i.setOptions([]),function(e){o=[];for(var t=0;t<_.select_options[t].length;t++)if(e==_.select_options[t].product_address_id)for(var d=_.select_options[t].box_date,i=0;i<d.length;i++)o.push({value:d[i].product_time_id,text:d[i].product_supply_time})}(e),i.setSelectedText("请选择装箱时间"),i.setOptions(o)}});t.address_list.push({address:s,time:i,assign_id:d.find("input[name='assign_driver_id']"),order_product_addressid:d.find("input[name='order_product_addressid']"),order_product_timeid:d.find("input[name='order_product_timeid']"),flag:flag})}else for(var n=1,c=0;c<e.address_info.length;c++){if(e.address_info[c].assign_status>2){var p=$(complete_item_tpl({box_address_detail:e.address_info[c].box_address_detail,box_time:e.address_info[c].box_time}));t.DOM.items_complete_container.append(p)}var m=!1;e.address_info[c].assign_status<3&&(m=!0);var d=$(item_tpl({flag:n,canChange:m,assign_driver_id:e.address_info[c].assign_id,order_product_addressid:e.address_info[c].product_address_id,order_product_timeid:e.address_info[c].product_time_id}));t.DOM.items_container.append(d),function(e){o=[];for(var t=0;t<_.select_options.length;t++)if(e==_.select_options[t].product_address_id)for(var d=_.select_options[t].box_date,i=0;i<d.length;i++)o.push({value:d[i].product_time_id,text:d[i].product_supply_time})}(e.address_info[c].product_address_id);var u=d.find(".boxData-selector"),f=d.find(".boxAddress-selector");if(0!==u.length||0!==f.length){var i=new select({width:380,container:d.find(".boxData-selector"),options:o,defaultText:e.address_info[c].box_time,defaultValue:e.address_info[c].product_time_id,options_max_height:160,onSelectChange:function(e,t,d){d.select.select_box.removeClass("error")}}),s=new select({width:380,container:d.find(".boxAddress-selector"),options:a,defaultText:e.address_info[c].box_address_detail,defaultValue:e.address_info[c].product_address_id,onSelectChange:function(e,t,d){d.select.select_box.removeClass("error"),i.setSelectedVal(""),i.setSelectedText("请先选择装箱地址"),i.setOptions([]),function(e){o=[];for(var t=0;t<_.select_options.length;t++)if(e==_.select_options[t].product_address_id)for(var d=_.select_options[t].box_date,i=0;i<d.length;i++)o.push({value:d[i].product_time_id,text:d[i].product_supply_time})}(e),i.setSelectedText("请选择装箱时间"),i.setOptions(o)}});t.address_list.push({address:s,time:i,assign_id:d.find("input[name='assign_driver_id']"),order_product_timeid:d.find("input[name='order_product_timeid']"),order_product_addressid:d.find("input[name='order_product_addressid']"),order_product_timeid:d.find("input[name='order_product_timeid']"),flag:n})}else t.address_list.push({assign_id:d.find("input[name='assign_driver_id']"),order_product_addressid:d.find("input[name='order_product_addressid']"),order_product_timeid:d.find("input[name='order_product_timeid']"),flag:n});n++}_.data.id=e.box_id},t.prototype.onComplete=function(){},t.prototype.init_popup=function(){var e=this;e.DOM.title.text(r),XDD.Request({url:"/carteam/order/choose_driver",type:"post",data:{carTeamId:_.carTeam_id},success:function(t){if(0!=t.error_code)return void(e.msg=t.error_msg||"未知错误！");var d=t.data,i=d.length;if(0==i)return void(e.msg="您未添加司机信息，请与管理员联系！");for(var s,r=[],s=0;i>s;s++)r.push({value:d[s].userid,text:d[s].driver_name+"/"+d[s].car_number});e.driverSelector=new select({width:380,container:e.DOM.driver,options:r,defaultText:"请选择司机",defaultValue:"",onSelectChange:function(e,t,d){d.select.select_box.removeClass("error")}}),e.can_open=!0,e.msg=""}},!0)},new t}var popup=require("common/module/popup/popup.js"),tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div id="assignPop"><div class="assignPop-title clearfix"><div class="assignPop-cancel"><button class="cancelBtn">取消</button></div><div class="title-text">上传信息</div><div class="assignPop-comfire"><button class="comfireBtn">确定</button></div></div><dl class="assignPop-driver-item first clearfix"><dd class="item"><div class="item-name"><label for="assignPop-seal-num">司机：</label></div><div class="item-content"><p class="driver-name"></p>                <div id="driver-selector"></div></div>            <div class="item-message clearfix">                <div class="error-message hidden"><i class="icon-warn"></i></div>                <div class="right-message hidden"><i class="icon-right"></i></div>            </div></dd></dl><div class="assignPop-address-complete-info"></div><div class="assignPop-address-info"></div><button class="add-other-BoxInfo">添加其他产装信息</button></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],item_tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<dl class="assign-adrress-items '),canChange||_template_fun_array.push("hidden"),_template_fun_array.push('" data-flag="',"undefined"==typeof flag?"":baidu.template._encodeHTML(flag),'"><div class="clearfix address-bottom-line"></div><input type="hidden" class="assign_driver_id" name="assign_driver_id" value="',"undefined"==typeof assign_driver_id?"":baidu.template._encodeHTML(assign_driver_id),'"/><input type="hidden" class="order_product_addressid" name="order_product_addressid" value="',"undefined"==typeof order_product_addressid?"":baidu.template._encodeHTML(order_product_addressid),'"/><input type="hidden" class="order_product_timeid" name="order_product_timeid" value="',"undefined"==typeof order_product_timeid?"":baidu.template._encodeHTML(order_product_timeid),'"/>'),canChange&&_template_fun_array.push('<dd class="item"><div class="item-name"><label for="assignPop-seal-num">装箱地址：</label></div><div class="item-content">            <div class="boxAddress-selector"></div></div>        <div class="item-message clearfix">            <div class="error-message hidden"><i class="icon-warn"></i></div>            <div class="right-message hidden"><i class="icon-right"></i></div>        </div></dd><div class="assign-delContainer"></div><dd class="item"><div class="item-name"><label for="assignPop-seal-num">装箱时间：</label></div><div class="item-content">            <div class="boxData-selector"></div></div>        <div class="item-message clearfix">            <div class="error-message hidden"><i class="icon-warn"></i></div>            <div class="right-message hidden"><i class="icon-right"></i></div>        </div></dd>'),_template_fun_array.push("</dl>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],complete_item_tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<dl class="assign-adrress-complete-items"><div class="clearfix address-bottom-line"></div><dd class="item"><div class="item-name"><label>详细装箱地址：</label></div><div class="item-content">',"undefined"==typeof box_address_detail?"":baidu.template._encodeHTML(box_address_detail),'</div></dd><div class="assign-delContainer"></div><dd class="item"><div class="item-name"><label for="assignPop-seal-num">装箱时间：</label></div><div class="item-content">',"undefined"==typeof box_time?"":baidu.template._encodeHTML(box_time),"</div></dd></dl>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],select=require("common/module/select/select.js");module.exports=AssignPop});
;/*!/order/widget/view/order_details/partial/box_info/box_info.js*/
define("order/widget/view/order_details/partial/box_info/box_info",function(require,exports,module){function bind(e,t,o,a){location.hash;var r=new Cards({width:300});global_box=e,global_addressInfo=o;var n={$scope:$(".boxInfo-wrapper")},s=EnsupePop({data:{orderId:t}});n.$scope.on("click",".funcs a.add-ensupe",function(){{var e=$(this),o=e.parents("tr"),a=o.find("td"),r=e.attr("data-id");getBoxAddressIndex(r),$(a[1]),$(a[2])}s.setAdd({boxId:r}),s.show(),s.onComplete=function(){window.location.href="/order/details?orderid="+t+"&dispatch=2#"+o.attr("id")}}),n.$scope.on("click",".funcs a.edit-ensupe",function(){var e=$(this),o=e.parents("tr"),a=o.find("td"),r=e.attr("data-id"),n=getBoxAddressIndex(r);if(!global_box[n].box_can_change)return void _alert("该箱子已经产装完成！");$(a[1]),$(a[2]);s.setEdit({boxId:r,orderId:t,boxNum:global_box[n].box_code,sealNum:global_box[n].box_ensupe}),s.show(),s.onComplete=function(){window.location.href="/order/details?orderid="+t+"&dispatch=2#"+o.attr("id")}});var d=AssignPop({data:{orderId:t},carTeam_id:a,select_options:global_addressInfo});n.$scope.on("click",".funcs a.add-assign",function(){if(!d.can_open)return void _alert(d.msg);{var e=$(this),o=e.parents("tr"),a=o.find("td"),r=$(this).attr("data-id");getBoxAddressIndex(r),$(a[3]),$(a[4]),$(a[5])}d.setAdd(r),d.onComplete=function(){window.location.href="/order/details?orderid="+t+"&dispatch=2#"+o.attr("id")},d.show()}),n.$scope.on("click",".funcs a.edit-assign",function(){if(!d.can_open)return void _alert(d.msg);{var e=$(this),o=e.parents("tr"),a=o.find("td"),r=$(this).attr("data-id"),n=getBoxAddressIndex(r);$(a[3]),$(a[4]),$(a[5])}d.setEdit(global_box[n]),d.onComplete=function(){window.location.href="/order/details?orderid="+t+"&dispatch=2#"+o.attr("id")},d.show()});var i;n.$scope.on("mouseover",".funcs i.icon-status-message",function(e){var t=$(this),o=function(t){r.setContent('<p style="text-align:center;">正在加载中...</p>'),r.show(e);var o=t.attr("data-boxid"),a="";XDD.Request({url:"/order/boxtimeline",type:"get",data:{orderboxid:o},success:function(e){if(0==e.error_code){var t,o=e.data.length;if(o>0)for(t=0;o>t;t++)a+='<p><span style="margin-right:5px;">'+e.data[t].create_time+"</span>"+e.data[t].content+"</p>";else a='<p style="text-align:center;">暂无物流信息！</p>';r.setContent(a)}else r.setContent('<p style="text-align:center;">'+e.error_msg+"</p>")}})};i=setTimeout(function(){o(t)},800)}).on("mouseleave",".funcs i.icon-status-message",function(){clearTimeout(i),r.hide()}),n.$scope.on("click",".address-details a.complete",function(){var e,o=$(this),a=o.attr("data-aid"),r="";a&&(XDD.Request({url:"/order/assignStatus",type:"get",data:{assignId:a,orderId:t},success:function(t){if(0==t.error_code){if(e=t.data.status,2==e)r="司机未确认产装，是否确认产装？";else{if(100!=e)return;r="司机已确认产装，是否确认产装？"}confirm_Pop.setData(r),confirm_Pop.show()}else _alert(t.error_msg||"未知错误！")}}),confirm_Pop.onConfirm=function(){XDD.Request({url:"/carteam/order/driver_equipment_complete",data:{assign_id:a},success:function(e){0==e.error_code?(_alert("产装完成！"),window.location.reload()):_alert(e.error_msg||"未知错误！")}},!0)})})}function getBoxAddressIndex(e){if(global_box&&e){var t,o,a=global_box.length;for(o=0;a>o;o++)global_box[o].box_id==e&&(t=o);return t}}var EnsupePop=require("order/module/ensupe_pop/ensupe_pop.js"),AssignPop=require("order/module/assign_pop/assign_pop.js"),Cards=require("common/module/cards/cards.js"),select=require("common/module/select/select.js"),box_details_tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<ul class="box-no-complete '),length===i+1&&_template_fun_array.push("last"),_template_fun_array.push('"><li class="clearfix"><div class="address-content"><p class="address">',"undefined"==typeof box_address_detail?"":baidu.template._encodeHTML(box_address_detail),'</p><p class="time">',"undefined"==typeof box_time?"":baidu.template._encodeHTML(box_time),'</p></div><a href="javascript:;" class="complete" data-aid="',"undefined"==typeof assign_driver_id?"":baidu.template._encodeHTML(assign_driver_id),'">产装完成</a></li></ul>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],Confirm=require("common/module/confirm/confirm.js"),global_box,global_addressInfo,confirm_Pop=new Confirm;module.exports={init:function(e,t,o,a){bind(e,t,o,a)}}});
;/*!/order/module/remark/remark.js*/
define("order/module/remark/remark",function(require,exports,module){var popup=require("common/module/popup/popup.js"),tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div id="remark" class="unselectable"><h3>请对车队服务做出评价</h3><ul data-star="-1" class="star-wrapper"><li><span></span></li><li><span></span></li><li><span></span></li><li><span></span></li><li><span></span></li></ul><div class="remark-content"><div class="content-wrap">请选择</div></div><div class="submit-wrap"><a href="javascript:;" class="user-btn" id="remark-submit">提交评价</a></div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],REMARK_TXT=["失望","不满","一般","满意","很满意"],remark=function(){function t(){this.wrap=$(".star-wrapper"),this.stars=this.wrap.find("li"),this.wrap_txt=$(".content-wrap"),a.call(this)}function a(){var t=this;t.stars.on("mouseenter",function(){var a=$(this),r=a.index();t.starOn(r)}).click(function(){var a=$(this),r=a.index();t.wrap.attr("data-star",r)}),t.stars.on("mouseleave",function(){var a=t.wrap.attr("data-star");t.starOn(a)}),$("#remark-submit").click(function(){var a=parseInt(t.wrap.attr("data-star"))+1;0>=a?t.wrap_txt.addClass("red"):(console.log({orderID:t.orderId,value:a}),XDD.Request({url:"/order/comment/detail",data:{order_id:t.orderId,score:a},success:function(a){0==a.error_code?(t.hide(),_alert("评价成功！"),setTimeout("window.location.href ='/order/list'",1e3)):(t.hide(),_alert(a.error_msg))}},!0))})}return t.prototype=new popup({title:!1,height:380,width:330,tpl:tpl}),t.prototype.constructor=t,t.prototype.setId=function(t){this.starOff(),this.orderId=t},t.prototype.starOn=function(t){this.starOff();for(var a=[],r=0;t>=r;r++)a.push(this.stars[r]);$(a).addClass("on"),this.wrap_txt.html(REMARK_TXT[t])},t.prototype.starOff=function(){this.stars.removeClass("on"),this.wrap_txt.removeClass("red"),this.wrap_txt.html("请选择")},new t};module.exports=remark});
;/*!/order/widget/view/order_list/order_list.js*/
define("order/widget/view/order_list/order_list",function(e,t,a){function r(e,t){var a=$("#order_search .search-btn"),r=$("#order_search input[name='searchValue']"),l=$("#order_search input[name='searchType']"),o=$("#order_search .clear-btn"),c="";c=1==e?"委托方":"承运方";var i,u=["",c,"提单号","运单号","船公司"];t?(i=new n({container:"#searchTypeSelector",options:[{value:1,text:u[1]},{value:2,text:u[2]},{value:3,text:u[3]},{value:4,text:u[4]}],height:40,width:80,defaultValue:t||1,defaultText:u[t]||u[1],text_align:"center",options_max_height:300,onSelectChange:function(e,t){e?(r.attr("placeholder","请输入"+t),l.val(e)):(r.attr("placeholder",u[1]+"提单号/运单号/船公司"),l.val(0))}}),r.attr("placeholder",u[t])):(i=new n({container:"#searchTypeSelector",options:[{value:1,text:u[1]},{value:2,text:u[2]},{value:3,text:u[3]},{value:4,text:u[4]}],height:40,width:80,defaultValue:1,defaultText:u[1],text_align:"center",options_max_height:300,onSelectChange:function(e,t){e?(r.attr("placeholder","请输入"+t),l.val(e)):(r.attr("placeholder",u[1]+"提单号/运单号/船公司"),l.val(0))}}),r.attr("placeholder","请输入"+u[1])),r.on("keyup",function(e){13==e.keycode&&a.trigger("click")}),a.on("click",function(e){var t=r.val(),a=l.val();(!a||0==a&&t)&&(_alert("请选择搜索类型！"),e.preventDefault())}),o.on("click",function(){r.val(""),r.focus()})}var l=e("order/module/remark/remark.js"),n=e("common/module/select/select.js");a.exports={init:function(e,t){r(e,t);var a={remark:$(".btn_remark")},n=null;a.remark.click(function(){var e=$(this),t=e.attr("data-odid");n||(n=l()),n.setId(t),n.show()})}}});
;/*!/order/widget/view/order_new/order_new.js*/
define("order/widget/view/order_new/order_new",function(e,n,a){function t(e,n){function a(e){for(var n=0;x>n;n++){var a=e[n].carteamId,t=e[n].carteamName;w[n]={text:t,value:a}}}function t(e,n){var a=$(e).parent(".btn-wrap"),t=$(a).prev(".upload-show"),i=$(t).find(".filename");$(t).removeClass("hidden"),$(i).html(n)}function o(e){var n=$(e).prev(".show-box"),a=$(n).parent(".upload-show"),t=$(n).children(".filename"),i=$(a).parent(".item-content").next(".item-message"),o=$(i).children(".right-message");$(t).html(""),$(a).addClass("hidden"),$(o).addClass("hidden")}function d(e){var n=$(e),a=n.val();return a?a:!1}function s(e){var n=$(e),a=n.val();return/^(\d|[a-zA-Z])+$/.test(a)?a:!1}function l(){var e=S.val();return e}function c(e){{var n=$(e).parents(".item-content"),a=$(n).next(".item-message"),t=$(a).children(".error-message");$(a).children(".right-message")}$(t).removeClass("hidden")}function h(e){var n=$(e).parents(".item-content"),a=$(n).next(".item-message"),t=$(a).children(".china-notice"),i=$(a).children(".right-message");$(t).removeClass("hidden"),$(i).addClass("hidden")}function u(e){var n=$(e).parents(".item-content"),a=$(n).next(".item-message"),t=$(a).children(".ajax-notice"),i=$(a).children(".right-message");$(t).removeClass("hidden"),$(i).addClass("hidden")}function m(e){var n=$(e).parents(".item-content"),a=$(n).next(".item-message"),t=$(a).children(".error-message"),i=$(a).children(".china-notice"),o=$(a).children(".right-message");$(e).removeClass("error"),$(t).addClass("hidden"),$(o).removeClass("hidden"),$(i).addClass("hidden")}var g,f,_,v,p,x=e.length,w=[],C=n,b=new Date,z=b.getFullYear(),j=b.getMonth()+1,D=b.getDate();p="日期："+z+"-"+(10>j?"0"+j:j)+"-"+(10>D?"0"+D:D),$(".number-left").html(p),console.log("aaa="+p),a(e);var S=new i({container:"#carteam-selector",width:500,heigth:34,options:w,defaultText:"请选择",defaultValue:"0"});$("#upload-chanzhuang").AjaxFileUpload({action:"/api/freight/order/upload_chanzhuang",onSubmit:function(){r.show({btn:$("#order-new .chanzhuang_btn"),txt:"正在上传...",showLoad:!1})},onComplete:function(e,n){console.log(e,n),r.hide(),n.data.pic_url&&(t("#upload-chanzhuang",e),f=n.data.pic_url)},onError:function(){r.hide()}}),$("#upload-tixiang").AjaxFileUpload({action:"/api/freight/order/upload_tixiang",onSubmit:function(){r.show({btn:$("#order-new .tixiang_btn"),txt:"正在上传...",showLoad:!1})},onComplete:function(e,n){console.log(e,n),r.hide(),n.data.pic_url&&(t("#upload-tixiang",e),v=n.data.pic_url)},onError:function(){r.hide()}}),$("#chanzhuang-delete").on("click",function(){o("#chanzhuang-delete"),f=""}),$("#tixiang-delete").on("click",function(){o("#tixiang-delete"),v=""}),$("#tidan_name").blur(function(){var e=$("#tidan_name").val(),n=d("#tidan_name"),a=s("#tidan_name");if(!n)return c("#tidan_name"),$("#tidan_name").focus(),void $("#tidan_name").addClass("error");if(m("#tidan_name"),""!=e||null!=e){if(!a)return h("#tidan_name"),$("#tidan_name").focus(),void $("#tidan_name").addClass("error");m("#tidan_name")}}),$(".order-creat").on("click",function(){var e=$(this);return g=l(),_=d("#tidan_name"),_tidanString=s("#tidan_name"),"0"==g?(c(".select-box"),$(".select-box").focus(),void $(".select-box").addClass("error")):($(".select-box").removeClass("error"),m(".select-box"),f?(m(".chanzhuang-show"),_?(m("#tidan_name"),_tidanString?(m("#tidan_name"),v?(m(".tixiang-show"),r.show({btn:e,txt:"正在创建...",showLoad:!1}),void XDD.Request({url:"/freight/order/ladingCodeExist?tidanCode="+_,success:function(e){0==e.error_code?XDD.Request({url:"/freight/order/new",data:{tidan:_,yundan:C,carteamId:g,tixiang:v,chanzhuang:f},success:function(e){0==e.error_code?(_alert("提交成功，请等待审核"),window.location.href="/order/list"):(_alert(e.error_msg),1002==e.error_code&&setTimeout("window.location.href = '/freight/order/choose'",2e3)),r.hide()}},!0):(u("#tidan_name"),$("#tidan_name").focus(),$("#tidan_name").addClass("error"),r.hide())}})):void c(".tixiang-show")):(h("#tidan_name"),$("#tidan_name").focus(),void $("#tidan_name").addClass("error"))):(c("#tidan_name"),$("#tidan_name").focus(),void $("#tidan_name").addClass("error"))):void c(".chanzhuang-show"))})}e("common/module/upload/uploader.js");var i=e("common/module/select/select.js"),o=e("common/module/loadingBtn/loadingBtn.js"),r=new o;a.exports={init:function(e,n){t(e,n)}}});
;/*!/order/widget/view/order_choose/order_choose.js*/
define("order/widget/view/order_choose/order_choose",function(e,o,t){function n(){new c({container:"#docks-selector",options:[{text:"天津",value:"1"}],defaultValue:"1",defaultText:"天津",width:280});$("#choose-out").on("click",function(){$(this).addClass("current"),$("#choose-in").removeClass("current")})}var c=e("common/module/select/select.js");t.exports={init:function(){n()}}});
;/*!/order/widget/view/order_trace/order_trace.js*/
define("order/widget/view/order_trace/order_trace",function(){});
;/*!/order/widget/view/order_trace/templete/order_trace_details/order_trace_details.js*/
define("order/widget/view/order_trace/templete/order_trace_details/order_trace_details",function(require,exports,module){function windowOnLoad(){window.onload=function(){setLineHeight()}}function setLineHeight(){DOM.item_line=DOM.item.find(".line"),DOM.item_line.each(function(){var t=$(this),e=t.parent(".traceline").parent("li"),n=e.outerHeight();t.height(n)})}function showBoxDetail(t,e){var n=window.location.href,o=n.indexOf("#/"),i=n.substring(o+2,n.length);DOM.box_details.hide(),i&&!isNaN(i)&&1!=i&&DOM.box_details[i-1]?($(DOM.box_details[i-1]).show(),setLineHeight(),t[i-1]&&t[i-1].location_info?(setMapPoint({packing_point:t[i-1].location_info.chanzhuang,current_point:{lng:t[i-1].location_info.current.longitude||0,lat:t[i-1].location_info.current.latitude||0},drop_point:{lng:t[i-1].location_info.duichang.longitude||0,lat:t[i-1].location_info.duichang.latitude||0}},e),e.map.setFitView()):(e.clear(),DOM.trace_address.html("未定位到司机当前位置！"))):($(DOM.box_details[0]).show(),setLineHeight(),t[0]&&t[0].location_info?(setMapPoint({packing_point:t[0].location_info.chanzhuang,current_point:{lng:t[0].location_info.current.longitude||0,lat:t[0].location_info.current.latitude||0},drop_point:{lng:t[0].location_info.duichang.longitude||0,lat:t[0].location_info.duichang.latitude||0}},e),e.getAddressByPoint({point:{lng:t[0].location_info.current.longitude||0,lat:t[0].location_info.current.latitude||0}},function(t,e){DOM.trace_address.html(1==t?e.regeocode.formattedAddress:"未定位到司机当前位置！")}),e.map.setFitView()):(e.clear(),DOM.trace_address.html("未定位到司机当前位置！")))}function watchHashChange(t,e){window.onhashchange=function(){showBoxDetail(t,e)}}function setMapPoint(t,e){e.clear();var n=infoWindowTpl({info_class:"current",text_class:"",text:"当前位置"}),o=infoWindowTpl({info_class:"leave",text:"产装地址"}),i=infoWindowTpl({info_class:"normal",text:"落箱堆场"});if(t.current_point&&0!=t.current_point.lng&&0!=t.current_point.lat){{e.createMarker({point:t.current_point})}e.getAddressByPoint({point:t.current_point},function(t,e){DOM.trace_address.html(1==t?e.regeocode.formattedAddress:"未定位到司机当前位置！")})}else DOM.trace_address.html("未定位到司机当前位置！");if(t.packing_point&&0!==t.packing_point.length)for(var a=[],r=0;r<t.packing_point.length;r++){var l=t.packing_point[r];if(0!=l.latitude&&0!=l.longitude){var c=e.createBespokeMarker({point:{lng:l.longitude,lat:l.latitude},html:o,offset:{left:-50,top:-12}});c.on("mouseover",function(){var t=infoWindowTpl({info_class:"normal",text:"产装地址"});this.setContent(t),this.setTop(!0)}),c.on("mouseout",function(){var t=infoWindowTpl({info_class:"leave",text:"产装地址"});this.setContent(t),this.setTop(!1)}),a.push(c)}}if(t.drop_point&&0!=t.drop_point.lng&&0!=t.drop_point.lat){e.createBespokeMarker({point:t.drop_point,html:i,offset:{left:-50,top:-12}})}if(t.current_point&&0!=t.current_point.lng&&0!=t.current_point.lat){e.createInfoWindow({point:t.current_point,html:n,onOpenning:!0,offset:{left:2,top:3}})}}var infoWindowTpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div id="trace-info" class="info ',"undefined"==typeof info_class?"":baidu.template._encodeHTML(info_class),'"><div class="text">',"undefined"==typeof text?"":baidu.template._encodeHTML(text),'</div><div class="square"></div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],Map=require("common/module/map/map.js"),DOM={item:$("#trace_details_content .content li"),box_details:$("#trace_details_content .details .box_detail"),trace_address:$("#trace_details_content .box_address span")};module.exports={init:function(t){var e=new Map("trace_map");windowOnLoad(),showBoxDetail(t,e),watchHashChange(t,e)}}});
;/*!/order/widget/view/order_trace/templete/order_trace_sidebar/order_trace_sidebar.js*/
define("order/widget/view/order_trace/templete/order_trace_sidebar/order_trace_sidebar",function(e,i,t){function a(){var e=window.location.href,i=e.indexOf("#/"),t=e.substring(i+2,e.length);r.box_item.removeClass("active"),t&&!isNaN(t)&&1!=t&&r.box_item[t-1]?$(r.box_item[t-1]).addClass("active"):$(r.box_item[0]).addClass("active")}var r={box_item:$("#order_trace_sidebar li")};t.exports={init:function(){a(),r.box_item.on("click",function(){r.box_item.removeClass("active"),$(this).addClass("active")})}}});
;/*!/order/module/quit_load/quit_load.js*/
define("order/module/quit_load/quit_load",function(require,exports,module){var popup=require("common/module/popup/popup.js"),tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div id="quit_loading_box"><div class="logo"></div><dl><dd class="clearfix"><input type="password" id="quit_confirm" placeholder="请输入密码" maxlength="16"/><span class="icon-pass"></span></dd><dd id="quit_captcha_wrap" class="clearfix hidden"><input type="text" id="quit_captcha" placeholder="验证码" maxlength="4"/><div class="captcha-wrap"></div></dd></dl><div id="quit_tip" class="invisible"></div><a href="javascript:;" id="confirm_submit">确定</a></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],confirmQuit=function(){function t(){a.call(this)}function a(){r.click(function(){var t=e();t&&XDD.Request({url:"/index/do_login",data:{password:t},success:function(t){console.log(t),0==t.error_code?location.href="/order/details":i(t.error_msg)}})})}function e(){var t=l.val();return(t.length=0)?void i("请输入密码",l,"password"):t.length<6?void i("密码不少于6位",l,"password"):("password"==u&&n(),t)}function i(t,a,e){u=e,p.html(t),p.removeClass("invisible"),a&&o(a),clearTimeout(d),d=setTimeout(function(){n()},5e3)}function n(){p.addClass("invisible")}function o(t){t.animate({marginLeft:"-1px"},40).animate({marginLeft:"2px"},40).animate({marginLeft:"-2px"},40).animate({marginLeft:"1px"},40).animate({marginLeft:"0px"},40).focus()}t.prototype=new popup({title:!1,height:280,width:330,tpl:tpl}),t.prototype.constructor=t,t.prototype.setHeight=function(t){this.pop.height(t)};var r=$("#confirm_submit"),l=$("#quit_confirm"),p=($("#quit_captcha"),$("#quit_tip")),u="",d=null;return new t};module.exports=confirmQuit});
;/*!/order/widget/com/order_file_download/order_file_download.js*/
define("order/widget/com/order_file_download/order_file_download",function(o,e,n){function t(){var o=$("#download-one").attr("href"),e=$("#download-two").attr("href");i.on("click",function(){r(o,e)})}function r(){for(var o=[],e=0;e<arguments.length;e++)if(arguments[e]){var n=$('<iframe style="visibility: collapse;"></iframe>');o.push(n),$("body").append(n);var t=n[0].contentDocument,r='<form action="'+arguments[e]+'" method="GET"></form>';t.write(r),$("form",t).submit()}setTimeout(function(){for(var e=0,n=o.length;n>e;e++)o[e].remove()},3e3)}var i=$("#download-all");i.show(),n.exports={init:function(){t()}}});
;/*!/order/widget/view/print_product_address/print_product_address.js*/
define("order/widget/view/print_product_address/print_product_address",function(n,d,o){function t(){DOM={btnDownload:$("#download_address")},DOM.btnDownload.click(function(){})}o.exports={init:function(){t()}}});
;/*!/order/widget/view/print_reconstrucct_msg/addressBox.js*/
define("order/widget/view/print_reconstrucct_msg/addressBox",function(require,exports,module){function AddressBox(e){var a={item:e.item||1},s=this.list=[],i=$(CONST.SCOPE+" .address-item"),t=a.item,d=$(CONST.SCOPE+" .add-address"),r=$('<a class="del-AddressBtn" href="javaScript:">删除该地址</a>');$(CONST.SCOPE).on("mouseover",".address-item",function(){var e=$(this),a=e.attr("data-item");1!=a&&(r.show(),e.find(".address-del").html(r),r.attr("data-item",a))}),$(CONST.SCOPE).on("mouseleave",".address-item",function(){var e=$(this),a=e.attr("data-item");1!=a&&(r.hide(),r.removeAttr("data-item",a))}),$(CONST.SCOPE).on("click",".del-AddressBtn",function(){var e=$(this),a=e.attr("data-item");if(1!=a){var i,t=e.parents(".address-item"),d=s.length;for(i=0;d>i;i++)s.splice(i,1);t.remove();var r=$(CONST.SCOPE).find(".address-item .address-title .address-name .num");r.each(function(e){$(this).text(e+1)})}}),i.each(function(){var e=$(this),a=(e.find(".address-del"),new AddressItem(e));s.push(a)}),d.on("click",function(){if(!(t>19)){t++;var e=$(this),a=tpl({item:t}),i=$(a);e.before(i);var d=(i.find(".address-del"),new AddressItem(i));s.push(d);var r=$(CONST.SCOPE).find(".address-item .address-title .address-name .num");r.each(function(e){$(this).text(e+1)})}})}function AddressItem(e){function a(e){this.$scope=e;{var a=this;this.itemBox=new CommonBox({scope:e,config_array:[{keyName:"package_location",selector:e.find(".package_location"),require:CONST.is_require,type:CONST.address_select_type},{keyName:"package_address",selector:".package_address",require:CONST.is_require,type:CONST.input_type},{keyName:"linkman",selector:".linkman",require:CONST.no_require,type:CONST.input_type},{keyName:"contact",selector:".contact",require:CONST.no_require,type:CONST.input_type}]}),a.timeBoxEvent=new AddSelectTimeBox({container:a})}}return a.prototype.check=function(){var e=this.itemBox.check();return e.timeList=this.timeBoxEvent.getTimeBox(),e},new a(e)}var util=require("common/module/util.js"),CommonBox=require("order/widget/view/order_complete/commonBox.js"),AddSelectTimeBox=require("order/module/addSelectTimeBox/addSelectTimeBox.js"),tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<dl class="address-item clearfix" data-item=&#39;',"undefined"==typeof item?"":baidu.template._encodeHTML(item),'&#39;><dd class="address-title"><div class="address-name"><h4>产装地址<span class="num">',"undefined"==typeof item?"":baidu.template._encodeHTML(item),'</span></h4></div><div class="address-tip"><p>请详细填写每个产装地址同时间进行产装的的具体箱型箱量</p></div><div class="address-del"></div></dd><dt class="item package_date clearfix"><div class="item-name"><label for="package_date"><span class="name">装箱时间</span><span class="icon-require">*</span></label></div><div class="item-content"><div class="package_date_selectBox data_1 clearfix" data-flag="1"></div><a class="add-date" href="javaScript:">+增加其它装箱时间</a></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i>装箱时间必填</div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><dt class="item clearfix"><div class="item-name"><label for="package_location"><span class="name">装箱地</span><span class="icon-require">*</span></label></div><div class="item-content"><div class="package_location"></div></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i>装箱地必填</div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><dt class="item clearfix"><div class="item-name"><label for="package_address"><span class="name">详细地址</span><span class="icon-require">*</span></label></div><div class="item-content"><input type="text" value="" class="package_address" id="package_address" name="package_address" /></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i>详细地址必填</div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><dt class="item clearfix"><div class="item-name"><label for="linkman"><span class="name">工厂联系人</span></label></div><div class="item-content"><input type="text" value="" class="linkman" id="linkman" name="linkman" /></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i>工厂联系人必填</div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><dt class="item clearfix"><div class="item-name"><label for="contact"><span class="name">联系方式</span></label></div><div class="item-content"><input type="text" value="" id="contact" class="contact" name="contact" /></div><div class="item-message clearfix"><div class="error-message hidden"><i class="icon-warn"></i>联系方式必填</div><div class="right-message hidden"><i class="icon-right"></i></div></div></dt><div class="clearfix address-bottom-line"></div></dl>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],CONST={SCOPE:".address_info",is_require:!0,no_require:!1,input_type:"INPUT",weight_type:"WEIGHT",select_type:"SELECT",address_select_type:"ADDRESS"};AddressBox.prototype.check=function(){var e,a=[],s=this.list.length;for(e=0;s>e;e++)a.push(this.list[e].check());return a},module.exports=AddressBox});
;/*!/order/widget/view/print_reconstrucct_msg/commonBox.js*/
define("order/widget/view/print_reconstrucct_msg/commonBox",function(e,r,s){function t(e){var r,s=e.scope||$("body");r="object"==typeof e.config_array?e.config_array:[];for(var t={},a=r.length,v=0;a>v;v++){var d=r[v],u=d.keyName||"",m=d.selector||"",p=d.require,g=d.type||"",O=d.selectPlaceholder||"";selectOptions=d.selectOptions||[],t[u]={},function(e,r,o,a){(a===h.input_type||a===h.weight_type)&&(t[e].$=$(s).find(r),t[e].require=o,t[e].type=a),a===h.select_type&&(t[e].$=new l({container:$(s).find(r),width:500,height:34,options:selectOptions,placeholder:O,onSelectChange:function(e,r,s){s.select.select_box.removeClass("error");var t=i(s.select.select_box);t.error.hide(),c.isNull(e)?t.right.hide():t.right.show()}}),t[e].require=o,t[e].type=a),a===h.address_select_type&&(t[e].$=new n({wrap:r,width:145,level:3,text_align:"center",onProvinceSelectChange:function(e,r,s){e&&s.province.select.select_box.removeClass("error")},onCitySelectChange:function(e,r,s){e&&s.city.select.select_box.removeClass("error")},onAreaSelectChange:function(e,r,s){if(e){s.area.select.select_box.removeClass("error");var t=i(s.area.select.select_box);t.error.hide(),t.right.show()}}}),t[e].require=o,t[e].type=a)}(u,m,p,g)}this.$SCOPE=s,this.DOM=t,o(t,this.$SCOPE)}function o(e,r){for(var s in e){var t=s,o=e[s].require,a=e[s].$,l=e[s].type;!function(e,s,t,o){if(t&&(o===h.input_type&&(r.on("keyup","#"+s.attr("id"),function(){var e=$(this).val(),r=i($(this));$(this).removeClass("error"),c.isNull(e)&&r.right.hide(),c.isNull(e)||(r.error.hide(),r.right.show())}),r.on("blur","#"+s.attr("id"),function(){var e=$(this).val(),r=i($(this));c.isNull(e)?($(this).addClass("error"),r.error.show(),r.right.hide()):($(this).removeClass("error"),r.error.hide(),r.right.show())})),o===h.weight_type)){var a=s.siblings(".decrease"),l=s.siblings(".plus"),n=s.parent("li").parent("ul").find("input");a.on("click",function(){var e=i(s),r=0;s.removeClass("error");try{var t=new Number(s.val())}catch(o){var t=0;return void s.val(0)}c.isNumber(t)&&t>0?(s.val(t-1),r=t-1):s.val(0),r+=t,n.each(function(){var e=$(this);r+=e.val()}),r>0&&(n.removeClass("error"),e.error.hide())}),l.on("click",function(){var e=i(s),r=0;s.removeClass("error");try{var t=new Number(s.val())}catch(o){var t=0;return void s.val(0)}c.isNumber(t)&&t>=0?(s.val(t+1),r=t+1):s.val(0),n.each(function(){var e=$(this);r+=e.val()}),r>0&&(n.removeClass("error"),e.error.hide())}),s.on("keydown",function(e){var r=e.keyCode;r>47&&58>r||8!==r&&c.preventDefault(e)}),s.on("keyup",function(e){var r=e.keyCode,t=0;if(r>47&&58>r&&8!==!r){try{var o=new Number(s.val())}catch(e){return void s.val(0)}t+=o;var a=i(s);!c.isNumber(o)||0>=o||(s.removeClass("error"),n.each(function(){var e=$(this);t+=e.val()}),t>0&&(n.removeClass("error"),a.error.hide()))}})}}(t,a,o,l)}}function a(e){e.animate({marginLeft:"-1px"},40).animate({marginLeft:"2px"},40).animate({marginLeft:"-2px"},40).animate({marginLeft:"1px"},40)}function i(e){var r={message:e.parents(".item-content").siblings(".item-message")};return r.error=r.message.find(".error-message"),r.right=r.message.find(".right-message"),r}var c=e("common/module/util.js"),l=e("common/module/select/select.js"),n=e("common/module/address/address.js"),h={is_require:!0,no_require:!1,input_type:"INPUT",weight_type:"WEIGHT",select_type:"SELECT",address_select_type:"ADDRESS"};t.prototype={check:function(){var e=this,r={};for(var s in e.DOM){var t=s;switch(r[t]={val:e.DOM[t].$.val()},e.DOM[t].type){case h.input_type:var o=i(e.DOM[t].$);e.DOM[t].require&&c.isNull(r[t].val)?(r[t].checkPass=!1,e.DOM[t].$.addClass("error"),a(e.DOM[t].$),e.DOM[t].$.focus(),o.error.show(),o.right.hide()):e.DOM[t].require?(e.DOM[t].$.removeClass("error"),r[t].checkPass=!0,o.error.hide(),o.right.show()):(r[t].checkPass=!0,o.error.hide(),o.right.hide());break;case h.select_type:var o=i(e.DOM[t].$.select.select_box);e.DOM[t].require&&c.isNull(r[t].val)?(r[t].checkPass=!1,e.DOM[t].$.select.select_box.addClass("error"),a(e.DOM[t].$.select.select_box),o.error.show(),o.right.hide()):(e.DOM[t].$.select.select_box.removeClass("error"),r[t].checkPass=!0,o.error.hide(),o.right.show());break;case h.weight_type:var o=i(e.DOM[t].$),l=0,n=e.DOM[t].$.parent("li").parent("ul").find("input");n.each(function(){var e=$(this);l+=e.val()}),c.isNumber(l)&&0>=l?(e.DOM[t].$.addClass("error"),r[t].checkPass=!1,a(e.DOM[t].$),e.DOM[t].$.focus(),o.error.show(),o.right.hide()):(e.DOM[t].$.removeClass("error"),r[t].checkPass=!0,o.error.hide(),o.right.show());break;case h.address_select_type:var o=i(e.DOM[t].$.dom.wrap),v=e.DOM[t].$.getProvince().id,d=e.DOM[t].$.getCity().id,u=e.DOM[t].$.getArea().id;v?v&&!d?(e.DOM[t].$.province.select.select.select_box.removeClass("error"),e.DOM[t].$.city.select.select.select_box.addClass("error"),e.DOM[t].$.area.select.select.select_box.addClass("error"),a(e.DOM[t].$.dom.wrap),r[t].checkPass=!1,o.error.show(),o.right.hide()):v&&d&&!u?(e.DOM[t].$.province.select.select.select_box.removeClass("error"),e.DOM[t].$.city.select.select.select_box.removeClass("error"),a(e.DOM[t].$.dom.wrap),r[t].checkPass=!1,e.DOM[t].$.area.select.select.select_box.addClass("error"),o.error.show(),o.right.hide()):(e.DOM[t].$.province.select.select.select_box.removeClass("error"),e.DOM[t].$.city.select.select.select_box.removeClass("error"),e.DOM[t].$.area.select.select.select_box.removeClass("error"),r[t].checkPass=!0,o.error.hide(),o.right.show()):(e.DOM[t].$.province.select.select.select_box.addClass("error"),e.DOM[t].$.city.select.select.select_box.addClass("error"),e.DOM[t].$.area.select.select.select_box.addClass("error"),a(e.DOM[t].$.dom.wrap),r[t].checkPass=!1,o.error.show(),o.right.hide())}}return r}},s.exports=t});
;/*!/order/widget/view/print_reconstrucct_msg/print_reconstrucct_msg.js*/
define("order/widget/view/print_reconstrucct_msg/print_reconstrucct_msg",function(e,r,t){function o(e){var r=(a({data:{orderid:e}}),i());$("#order_complete_rec .order-save").on("click",function(){var t=r.fcBox.check(),o=r.shipBox.check(),i=r.productBox.check(),_=!0;return p(t)&&p(o)&&p(i)&&_?(n.show(),void(n.onComplete=function(r){var t={box_20gp_count:i["20gp"].val,box_40gp_count:i["40gp"].val,box_40hq_count:i["40hg"].val,orderid:e,password:r,product_box_type:i.product_type.val,product_desc:i.product_remark.val,product_name:i.product_name.val,product_weight:i.product_weight.val,ship_name:o.name.val,ship_ticket:o.num.val,shipping_company:o.company.val,tidan_code:o.tidan.val,yard:o.yard.val};XDD.Request({url:"/carteam/order/reConstruct",data:t,type:"get",success:function(e){n.hide(),0==e.error_code?(_alert("重建成功！"),window.location.href="/order/list"):_alert(e.error_msg)}})})):void _alert("您有信息未填写！")})}function p(e){var r=!0;for(var t in e)e[t]&&"boolean"==typeof e[t].checkPass&&!e[t].checkPass&&(r=!1);return r}function i(){var e,r,t;return e=new _({scope:$("#order_complete_rec .carteam_freight"),config_array:[{keyName:"freight_id",selector:"#freight_id",require:c.no_require,type:c.input_type},{keyName:"freight_name",selector:"#freight_name",require:c.no_require,type:c.input_type},{keyName:"carteam_id",selector:"#carteam_id",require:c.no_require,type:c.input_type},{keyName:"carteam_name",selector:"#carteam_name",require:c.no_require,type:c.input_type}]}),r=new _({scope:$("#order_complete_rec .ship_info"),config_array:[{keyName:"company",selector:"#ship_company",require:c.is_require,type:c.input_type},{keyName:"tidan",selector:"#tidan",require:c.is_require,type:c.input_type},{keyName:"name",selector:"#ship_name",require:c.is_require,type:c.input_type},{keyName:"num",selector:"#ship_num",require:c.is_require,type:c.input_type},{keyName:"yard",selector:"#ship_yard",require:c.is_require,type:c.input_type},{keyName:"ship_remark",selector:"#ship_remark",require:c.no_require,type:c.input_type}]}),t=new _({scope:$("#order_complete_rec .product_info"),config_array:[{keyName:"product_type",selector:"#product_type",require:c.no_require,type:c.input_type},{keyName:"20gp",selector:"#product_20gp",require:c.no_require,type:c.input_type},{keyName:"40gp",selector:"#product_40gp",require:c.no_require,type:c.input_type},{keyName:"40hg",selector:"#product_40hg",require:c.no_require,type:c.input_type},{keyName:"product_name",selector:"#product_name",require:c.no_require,type:c.input_type},{keyName:"product_weight",selector:"#product_weight",require:c.is_require,type:c.input_type},{keyName:"product_remark",selector:"#product_remark",require:c.no_require,type:c.input_type}]}),{fcBox:e,shipBox:r,productBox:t}}{var _=e("order/widget/view/order_complete/commonBox.js");e("order/widget/view/order_complete/addressBox.js")}e("common/module/searchBox/searchBox.js");var a=e("order/module/comfirm_psw_pop/comfirm_psw_pop.js"),c=(e("common/module/select/select.js"),{is_require:!0,no_require:!1,input_type:"INPUT",weight_type:"WEIGHT",select_type:"SELECT"}),n=a();t.exports={init:function(e){$("#order_complete_rec #ship_company").XDDSearchBox({resKeyName:"china_name",appKeyName:"english_name",keyId:"company_id"}),$("#order_complete_rec #ship_name").XDDSearchBox({url:"/carteam/order/search_ship_name",resKeyName:"china_name",appKeyName:"eng_name",keyId:"ship_name_id"}),$("#order_complete_rec #ship_yard").XDDSearchBox({url:"/carteam/order/search_yard",resKeyName:"yard_name",keyId:"yard_id"}),o(e)}}});
;/*!/order/widget/view/product_address_list/product_address_list.js*/
define("order/widget/view/product_address_list/product_address_list",function(i,t,n){function r(){function i(i){for(var t=$(i).children("td"),n=t.length-1,r=0;n>r;r++){var d=$(t[r]).text();if(!d){var d=$(t[5]).children("a");$(d).addClass("disable")}}}for(var t=$(".scope"),n=t.length,r=0;n>r;r++)i(t[r]);$(".print").on("click",function(){var i=$(this).hasClass("disable");return i?!1:void 0})}n.exports={init:function(){r()}}});